(this.$WP=this.$WP||[]).push(["tnit44",(e,t)=>{var a,i,r,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k,E,D,N,C,_,T,I,O,M,P,R,z,U,B,L,F,q,G,$,j,H,W,J,K,X,Y,V,Z,Q,ee,et,ea,ei,er,es,en,eo,el,eu,eh,ec,ed,ep,eb,em,eg,ef,ev,ex,ew,ey,eS,eA,ek,eE,eD,eN,eC,e_,eT,eI={Pn:function(e){for(var t=atob((e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/")),a=new Uint8Array(t.length),i=0;i<t.length;++i)a[i]=t.charCodeAt(i);return a}},eO={CustomEvent:"ce",Pr:"p",xl:"pc",cc:"ca",Ba:"i",qs:"ie",T:"cci",W:"ccic",_:"ccc",L:"ccd",_h:"ss",gh:"se",bi:"si",yi:"sc",ji:"sbc",vi:"sfe",ro:"iec",Ul:"lr",Ol:"uae",U:"ci",F:"cc",Bl:"lcaa",Wl:"lcar",Tn:"inc",En:"add",Fn:"rem",Un:"set",Gl:"sgu"},eM={qr:"feed_displayed",dc:"content_cards_displayed"},eP={nt:()=>{var e=e=>{var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t};return e()+e(!0)+e(!0)+e()}},eR={init:function(e){void 0===e&&void 0!==eR.zg||(eR.zg=!!e),eR.Eg||(eR.Eg=!0)},destroy:function(){eR.Eg=!1,eR.zg=void 0,eR.nd=void 0},setLogger:function(e){"function"==typeof e?(eR.init(),eR.nd=e):eR.info("Ignoring setLogger call since logger is not a function")},toggleLogging:function(){eR.init(),eR.zg?eR.zg=!1:eR.zg=!0},info:function(e){if(eR.zg){var t="Braze: "+e;null!=eR.nd?eR.nd(t):console.log(t)}},warn:function(e){if(eR.zg){var t="Braze SDK Warning: "+e+" (v4.6.3)";null!=eR.nd?eR.nd(t):console.warn(t)}},error:function(e){if(eR.zg){var t="Braze SDK Error: "+e+" (v4.6.3)";null!=eR.nd?eR.nd(t):console.error(t)}}},ez={ho:"allowCrawlerActivity",po:"baseUrl",Eo:"noCookies",_o:"devicePropertyAllowlist",ta:"disablePushTokenMaintenance",Io:"enableLogging",Ao:"enableSdkAuthentication",ia:"manageServiceWorkerExternally",So:"minimumIntervalBetweenTriggerActionsInSeconds",No:"sessionTimeoutInSeconds",wo:"appVersion",na:"serviceWorkerLocation",ra:"safariWebsitePushId",zn:"localization",ao:"contentSecurityNonce",To:"enableHtmlInAppMessages",Oo:"allowUserSuppliedJavascript",no:"inAppMessageZIndex",lo:"openInAppMessagesInNewTab",en:"openNewsFeedCardsInNewTab",eh:"requireExplicitInAppMessageDismissal",vo:"doNotLoadFontAwesome",Co:"sdkFlavor",tn:"openCardsInNewTab"};function eU(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&void 0!==e[a]&&t.push(e[a]);return t}function eB(e,t,a,i){var r=eU(e);return -1!==r.indexOf(t)||(en.D.error(`${a} Valid values from ${i} are "${r.join('"/"')}".`),!1)}function eL(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function eF(e){return"[object Date]"===Object.prototype.toString.call(e)}function eq(e){return"[object Object]"===Object.prototype.toString.call(e)}function eG(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(a);return t}function e$(e,t){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;var a=e.toString();if(a!==t.toString())return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}var i="[object Array]"===a;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var r=e.constructor,s=t.constructor;if(r!==s&&!("function"==typeof r&&r instanceof r&&"function"==typeof s&&s instanceof s)&&"constructor"in e&&"constructor"in t)return!1}for(var n=[],o=[],l=n.length;l--;)if(n[l]===e)return o[l]===t;if(n.push(e),o.push(t),i){if((l=e.length)!==t.length)return!1;for(;l--;)if(!e$(e[l],t[l]))return!1}else{var u,h=eG(e);if(l=h.length,eG(t).length!==l)return!1;for(;l--;)if(u=h[l],!t.hasOwnProperty(u)||!e$(e[u],t[u]))return!1}return n.pop(),o.pop(),!0}function ej(e,t){var a=e/1e3;return t&&(a=Math.floor(a)),a}function eH(e){var t=parseInt(e);return null==e||isNaN(t)?null:new Date(1e3*t)}function eW(e){return null!=e&&eF(e)?e.toISOString().replace(/\.[0-9]{3}Z$/,""):e}function eJ(e){return null==e||""===e?null:new Date(e)}function eK(e){return(new Date().valueOf()-e.valueOf())/1e3}function eX(e){return(e.valueOf()-new Date().valueOf())/1e3}var eY="inAppMessage must be an InAppMessage object",eV="must be a Card object",eZ={rE:"Chrome",eE:"Edge",Pg:"Internet Explorer",EE:"Opera",kg:"Safari",oE:"Firefox"},eQ={Fg:"Android",ln:"iOS",jg:"Mac",Dg:"Windows"};function e0(e){for(var t=e.length,a=e.length-1;a>=0;a--){var i=e.charCodeAt(a);i>127&&i<=2047?t++:i>2047&&i<=65535&&(t+=2),i>=56320&&i<=57343&&a--}return t}var e1={types:{ue:"container",logCustomEvent:"logCustomEvent",setEmailNotificationSubscriptionType:"setEmailNotificationSubscriptionType",setPushNotificationSubscriptionType:"setPushNotificationSubscriptionType",setCustomUserAttribute:"setCustomUserAttribute",requestPushPermission:"requestPushPermission",addToSubscriptionGroup:"addToSubscriptionGroup",removeFromSubscriptionGroup:"removeFromSubscriptionGroup",addToCustomAttributeArray:"addToCustomAttributeArray",removeFromCustomAttributeArray:"removeFromCustomAttributeArray",de:"openLink",pe:"openLinkInWebView"},properties:{type:"type",me:"steps",fe:"args"}},e3={Di:"unknownBrazeAction",_i:"noPushPrompt"},e5=(e,t)=>{switch(e){case e3.Di:return`${t} contains an unknown braze action type and will not be displayed.`;case e3._i:return`${t} contains a push prompt braze action, but is not eligible for a push prompt. Ignoring.`;default:return""}};function e2(e){try{var t=e.match(e6)[0].length,a=e.substring(t);if(t>e.length-1||!a)return void en.D.error(`Did not find base64 encoded brazeAction in url to process : ${e}`);var i=function(e){try{e=e.replace(/-/g,"+").replace(/_/g,"/");for(var t=window.atob(e),a=new Uint8Array(t.length),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);var r=new Uint16Array(a.buffer);return String.fromCharCode(...r)}catch(e){return en.D.error("Unable to decode Base64: "+e),null}}(a);return i?JSON.parse(i):void en.D.error(`Failed to decode base64 encoded brazeAction: ${a}`)}catch(t){return void en.D.error(`Failed to process brazeAction URL ${e} : ${t.message}`)}}function e4(e,t){var a=!1;for(var i of t)if(a=a||e(i))return!0;return!1}function e8(e){try{var t,a=e[e1.properties.type];return a===e1.types.ue?e4(e8,e[e1.properties.me]):(t=!1,Object.keys(e1.types).forEach(e=>{e1.types[e]!==a.toString()||(t=!0)}),!t)}catch(e){return!0}}var e7=/^[^\x00-\x1F\x22]+$/,e6=/^brazeActions:\/\/v\d+\//;function e9(e){var t=typeof e;return null==e||"number"===t||"boolean"===t||eF(e)||"string"===t}function te(e,t,a,i){var r="string"==typeof e||null===e&&i;return r||en.D.error(`Cannot ${t} because ${a} "${e}" is invalid.`),r}function tt(e,t,a){var i=null!=e&&"string"==typeof e&&(""===e||e.match(e7));return i||en.D.error(`Cannot ${t} because ${a} "${e}" is invalid.`),i}function ta(e,t,a,i,r){if(null==e&&(e={}),"object"!=typeof e||eL(e))return en.D.error(`${t} requires that ${a} be an object. Ignoring ${r}.`),[!1,null];var s,n=JSON.stringify(e);if(e0(n)>51200)return en.D.error(`Could not ${i} because ${a} was greater than the max size of 50KB.`),[!1,null];try{s=JSON.parse(n)}catch(e){return en.D.error(`Could not ${i} because ${a} did not contain valid JSON.`),[!1,null]}for(var o in e){if(!tt(o,i,`the ${r} property name`))return[!1,null];var l=e[o];if(null==l){delete e[o],delete s[o];continue}if(eF(l)&&(s[o]=eW(l)),!function(e,t,a,i){var r;return(r=eq(e)||eL(e)?function e(t,a){if(eL(t)&&eL(a)){for(var i=0;i<t.length&&i<a.length;i++)if(eF(t[i])&&(a[i]=eW(t[i])),!e(t[i],a[i]))return!1}else{if(!eq(t))return e9(t);for(var r of eG(t))if(eF(t[r])&&(a[r]=eW(t[r])),!e(t[r],a[r]))return!1}return!0}(e,t):e9(e))||en.D.error(`Cannot ${a} because ${i} "${e}" is invalid.`),r}(l,s[o],i,`the ${r} property "${o}"`))return[!1,null]}return[!0,s]}function ti(e){if(!(e1.properties.type in e))return!1;switch(e[e1.properties.type]){case e1.types.ue:if(e1.properties.me in e)return!0;break;case e1.types.logCustomEvent:case e1.types.setEmailNotificationSubscriptionType:case e1.types.setPushNotificationSubscriptionType:case e1.types.setCustomUserAttribute:case e1.types.addToSubscriptionGroup:case e1.types.removeFromSubscriptionGroup:case e1.types.addToCustomAttributeArray:case e1.types.removeFromCustomAttributeArray:case e1.types.de:case e1.types.pe:if(e1.properties.fe in e)return!0;break;case e1.types.requestPushPermission:return!0}return!1}var tr={eu:{su:"ab.storage.userId",Jo:"ab.storage.deviceId",Sh:"ab.storage.sessionId"},q:{Sa:"ab.test",Ta:"ab.storage.events",Ia:"ab.storage.attributes",Ka:"ab.storage.attributes.anonymous_user",Yo:"ab.storage.device",ha:"ab.storage.sdk_metadata",ca:"ab.storage.session_id_for_cached_metadata",Sn:"ab.storage.pushToken",ei:"ab.storage.newsFeed",hi:"ab.storage.lastNewsFeedRefresh",P:"ab.storage.cardImpressions",hl:"ab.storage.serverConfig",Ya:"ab.storage.triggers",Da:"ab.storage.triggers.ts",bh:"ab.storage.messagingSessionStart",Yt:"ab.storage.cc",vs:"ab.storage.ccLastFullSync",ys:"ab.storage.ccLastCardUpdated",$:"ab.storage.ccClicks",O:"ab.storage.ccImpressions",K:"ab.storage.ccDismissals",Ga:"ab.storage.lastDisplayedTriggerTimesById",Na:"ab.storage.lastDisplayedTriggerTime",va:"ab.storage.triggerFireInstancesById",Qn:"ab.storage.signature",As:"ab.storage.brazeSyncRetryCount",_s:"ab.storage.sdkVersion",ze:"ab.storage.ff",Ce:"ab.storage.ffLastRefreshAt"},ae:"ab.optOut"},ts={BROWSER:"browser",BROWSER_VERSION:"browserVersion",OS:"os",RESOLUTION:"resolution",LANGUAGE:"language",TIME_ZONE:"timeZone",USER_AGENT:"userAgent"},tn={Ra:"invalid_api_key",ba:"blacklisted",ga:"no_device_identifier",pa:"invalid_json_response",ma:"empty_response"},to={Hs:e=>{var t,a;try{if(window.XMLHttpRequest?t=new XMLHttpRequest:en.D.error("This browser does not have any supported ajax options!"),null!=t){var i=()=>{"function"==typeof e.error&&e.error(t.status),"function"==typeof e.Ue&&e.Ue(!1)};for(var r of(t.onload=()=>{var a,r;if(4===t.readyState){if(t.status>=200&&t.status<300||304===t.status){if("function"==typeof e.S){try{a=JSON.parse(t.responseText),r=t.getAllResponseHeaders()}catch(a){var s={error:""===t.responseText?tn.ma:tn.pa,response:t.responseText};e.S(s,r)}a&&e.S(a,r)}"function"==typeof e.Ue&&e.Ue(!0)}else i()}},t.onerror=()=>{i()},t.ontimeout=()=>{i()},a=JSON.stringify(e.data),t.open("POST",e.url,!0),t.setRequestHeader("Content-type","application/json"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.headers||[]))t.setRequestHeader(r[0],r[1]);t.send(a)}}catch(e){en.D.error(`Network request error: ${e.message}`)}}},tl=(e,t)=>(e=Math.ceil(e),Math.floor(Math.random()*((t=Math.floor(t))-e+1))+e),tu={Yr:()=>"serviceWorker"in navigator&&"undefined"!=typeof ServiceWorkerRegistration&&"showNotification"in ServiceWorkerRegistration.prototype&&"PushManager"in window,Hr:()=>"safari"in window&&"pushNotification"in window.safari&&"function"==typeof window.safari.pushNotification.permission&&"function"==typeof window.safari.pushNotification.requestPermission,isPushSupported:()=>tu.Yr()||tu.Hr(),isPushBlocked:()=>{var e=tu.isPushSupported()&&"Notification"in window&&null!=window.Notification&&null!=window.Notification.permission&&"denied"===window.Notification.permission,t=tu.isPushSupported()&&(!("Notification"in window)||null==window.Notification);return e||t},isPushPermissionGranted:()=>tu.isPushSupported()&&"Notification"in window&&null!=window.Notification&&null!=window.Notification.permission&&"granted"===window.Notification.permission,Ti:()=>!tu.isPushBlocked()&&tu.isPushSupported()&&!tu.isPushPermissionGranted()},th={Vo:(e,t)=>{var a=!1;try{if(localStorage&&localStorage.getItem)try{localStorage.setItem(tr.q.Sa,!0),localStorage.getItem(tr.q.Sa)&&(localStorage.removeItem(tr.q.Sa),a=!0)}catch(e){if("QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||!(localStorage.length>0))throw e;a=!0}}catch(e){en.D.info("Local Storage not supported!")}var i=th.Ea(),r=new g.wa(e,i&&!t,a),s=null;return s=a?new g._a(e):new g.Oa,new g(r,s)},Ea:()=>navigator.cookieEnabled||"cookie"in document&&(document.cookie.length>0||(document.cookie="test").indexOf.call(document.cookie,"test")>-1)};function tc(e,t,a,i){if(null==e)return!1;t=t||!1,a=a||!1;var r=e.getBoundingClientRect();return null!=r&&(r.top>=0&&r.top<=(window.innerHeight||document.documentElement.clientHeight)||!t)&&(r.left>=0||!i)&&(r.bottom>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)||!a)&&(r.right<=(window.innerWidth||document.documentElement.clientWidth)||!i)}var td={We:"up",Xe:"down",ot:"left",et:"right"};function tp(){if(null==ed.vu){ed.vu=!1;try{var e=Object.defineProperty({},"passive",{get:()=>{ed.vu=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(e){}}return ed.vu}function tb(e,t,a){e.addEventListener(t,a,!!tp()&&{passive:!0})}function tm(e){if(e.onclick){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.onclick.apply(e,[t])}}function tg(e,t,a){var i=null,r=null;tb(e,"touchstart",e=>{i=e.touches[0].clientX,r=e.touches[0].clientY}),tb(e,"touchmove",s=>{if(null!=i&&null!=r){var n=i-s.touches[0].clientX,o=r-s.touches[0].clientY;Math.abs(n)>Math.abs(o)&&Math.abs(n)>=25?((n>0&&t===td.ot||n<0&&t===td.et)&&a(s),i=null,r=null):Math.abs(o)>=25&&((o>0&&t===td.We&&e.scrollTop===e.scrollHeight-e.offsetHeight||o<0&&t===td.Xe&&0===e.scrollTop)&&a(s),i=null,r=null)}})}function tf(e,t,a){var i="http://www.w3.org/2000/svg",r=document.createElementNS(i,"svg");r.setAttribute("viewBox",e),r.setAttribute("xmlns",i);var s=document.createElementNS(i,"path");return s.setAttribute("d",t),null!=a&&s.setAttribute("fill",a),r.appendChild(s),r}var tv={fo:32,oo:9,co:13,ih:27};function tx(e){if(e.is_control)return N.fromJson(e);var t=e.type;null!=t&&(t=t.toUpperCase());var a=e.message,i=e.text_align_message,r=e.slide_from,s=e.extras,n=e.trigger_id,o=e.click_action,l=e.uri,u=e.open_target,h=e.message_close,c=e.duration,d=e.icon,p=e.image_url,b=e.image_style,m=e.icon_color,g=e.icon_bg_color,f=e.bg_color,v=e.text_color,x=e.close_btn_color,w=e.header,y=e.text_align_header,S=e.header_text_color,A=e.frame_color,k=[],E=e.btns;null==E&&(E=[]);for(var D=0;D<E.length;D++)k.push(T.fromJson(E[D]));var P,R=e.crop_type,z=e.orientation,U=e.animate_in,B=e.animate_out,L=e.html_id,F=e.css;if(null!=L&&""!==L&&null!=F&&""!==F||(L=void 0,F=void 0),t===O.es||t===C.es.Ye)P=new O(a,i,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,U,B,w,y,S,A,k,R,L,F);else if(t===I.es)P=new I(a,i,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,U,B,w,y,S,A,k,R,z,L,F);else if(t===M.es)P=new M(a,i,r,s,n,o,l,u,h,c,d,p,m,g,f,v,x,U,B,L,F);else{if(t!==_.es&&t!==C.es.cn)return void en.D.error("Ignoring message with unknown type "+t);var q=e.message_fields;(P=new _(a,s,n,h,c,U,B,A,L,F,q)).trusted=e.trusted||!1}return P.un=t,P}var tw={OPEN:"open",Rr:"purchase",vr:"push_click",be:"custom_event",Br:"iam_click",ks:"test"},ty={Ze:null,t:!1,m:()=>(ty.o(),ty.Ze||(ty.Ze=new j(eg.nr(),eg.g(),eg.l(),eg.p())),ty.Ze),o:()=>{ty.t||(eg.u(ty),ty.t=!0)},destroy:()=>{ty.Ze=null,ty.t=!1}};function tS(e,t,a){var i=e||document.querySelector("head"),r=`ab-${t}-css-definitions-${"4.6.3".replace(/\./g,"-")}`,s=i.ownerDocument||document;if(null==s.getElementById(r)){var n=s.createElement("style");n.innerHTML=a,n.id=r;var o=eg.nn(tj.ao);null!=o&&n.setAttribute("nonce",o),i.appendChild(n)}}function tA(){if(!eg.nn(tj.vo)){var e="https://use.fontawesome.com/7f85a56ba4.css";if(!(null!==document.querySelector('link[rel=stylesheet][href="'+e+'"]'))){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(t)}}}function tk(e){tS(e,"iam",".ab-pause-scrolling,body.ab-pause-scrolling,html.ab-pause-scrolling{overflow:hidden;touch-action:none}.ab-iam-root.v3{position:fixed;top:0;right:0;bottom:0;left:0;pointer-events:none;z-index:9011;-webkit-tap-highlight-color:transparent}.ab-iam-root.v3:focus{outline:0}.ab-iam-root.v3.ab-effect-fullscreen,.ab-iam-root.v3.ab-effect-html,.ab-iam-root.v3.ab-effect-modal{opacity:0}.ab-iam-root.v3.ab-effect-fullscreen.ab-show,.ab-iam-root.v3.ab-effect-html.ab-show,.ab-iam-root.v3.ab-effect-modal.ab-show{opacity:1}.ab-iam-root.v3.ab-effect-fullscreen.ab-show.ab-animate-in,.ab-iam-root.v3.ab-effect-html.ab-show.ab-animate-in,.ab-iam-root.v3.ab-effect-modal.ab-show.ab-animate-in{-webkit-transition:opacity .5s;-moz-transition:opacity .5s;-o-transition:opacity .5s;transition:opacity .5s}.ab-iam-root.v3.ab-effect-fullscreen.ab-hide,.ab-iam-root.v3.ab-effect-html.ab-hide,.ab-iam-root.v3.ab-effect-modal.ab-hide{opacity:0}.ab-iam-root.v3.ab-effect-fullscreen.ab-hide.ab-animate-out,.ab-iam-root.v3.ab-effect-html.ab-hide.ab-animate-out,.ab-iam-root.v3.ab-effect-modal.ab-hide.ab-animate-out{-webkit-transition:opacity .5s;-moz-transition:opacity .5s;-o-transition:opacity .5s;transition:opacity .5s}.ab-iam-root.v3.ab-effect-slide .ab-in-app-message{-webkit-transform:translateX(535px);-moz-transform:translateX(535px);-ms-transform:translateX(535px);transform:translateX(535px)}.ab-iam-root.v3.ab-effect-slide.ab-show .ab-in-app-message{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}.ab-iam-root.v3.ab-effect-slide.ab-show.ab-animate-in .ab-in-app-message{-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message{-webkit-transform:translateX(535px);-moz-transform:translateX(535px);-ms-transform:translateX(535px);transform:translateX(535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-left{-webkit-transform:translateX(-535px);-moz-transform:translateX(-535px);-ms-transform:translateX(-535px);transform:translateX(-535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-up{-webkit-transform:translateY(-535px);-moz-transform:translateY(-535px);-ms-transform:translateY(-535px);transform:translateY(-535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide .ab-in-app-message.ab-swiped-down{-webkit-transform:translateY(535px);-moz-transform:translateY(535px);-ms-transform:translateY(535px);transform:translateY(535px)}.ab-iam-root.v3.ab-effect-slide.ab-hide.ab-animate-out .ab-in-app-message{-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-iam-root.v3 .ab-ios-scroll-wrapper{position:fixed;top:0;right:0;bottom:0;left:0;overflow:auto;pointer-events:all;touch-action:auto;-webkit-overflow-scrolling:touch}.ab-iam-root.v3 .ab-in-app-message{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:fixed;text-align:center;-webkit-box-shadow:0 0 4px rgba(0,0,0,.3);-moz-box-shadow:0 0 4px rgba(0,0,0,.3);box-shadow:0 0 4px rgba(0,0,0,.3);line-height:normal;letter-spacing:normal;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;z-index:9011;max-width:100%;overflow:hidden;display:inline-block;pointer-events:all;color:#333}.ab-iam-root.v3 .ab-in-app-message.ab-no-shadow{-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.ab-iam-root.v3 .ab-in-app-message :focus,.ab-iam-root.v3 .ab-in-app-message:focus{outline:0}.ab-iam-root.v3 .ab-in-app-message.ab-clickable{cursor:pointer}.ab-iam-root.v3 .ab-in-app-message.ab-background{background-color:#fff}.ab-iam-root.v3 .ab-in-app-message .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021}.ab-iam-root.v3 .ab-in-app-message .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message .ab-close-button svg.ab-chevron{display:none}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:active{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:focus{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:hover{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-close-button:hover svg{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message .ab-message-text{float:none;line-height:1.5;margin:20px 25px;max-width:100%;overflow:hidden;overflow-y:auto;vertical-align:text-bottom;word-wrap:break-word;white-space:pre-wrap;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.start-aligned{text-align:start}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.end-aligned{text-align:end}.ab-iam-root.v3 .ab-in-app-message .ab-message-text.center-aligned{text-align:center}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar{-webkit-appearance:none;width:14px}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-thumb{-webkit-appearance:none;border:4px solid transparent;background-clip:padding-box;-webkit-border-radius:7px;-moz-border-radius:7px;border-radius:7px;background-color:rgba(0,0,0,.2)}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-button{width:0;height:0;display:none}.ab-iam-root.v3 .ab-in-app-message .ab-message-text::-webkit-scrollbar-corner{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-message-header{float:none;letter-spacing:0;margin:0;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;display:block;font-size:20px;margin-bottom:10px;line-height:1.3}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.start-aligned{text-align:start}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.end-aligned{text-align:end}.ab-iam-root.v3 .ab-in-app-message .ab-message-header.center-aligned{text-align:center}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message.ab-modal,.ab-iam-root.v3 .ab-in-app-message.ab-slideup{-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;cursor:pointer;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;font-size:14px;font-weight:700;margin:20px;margin-top:calc(constant(safe-area-inset-top,0) + 20px);margin-right:calc(constant(safe-area-inset-right,0) + 20px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 20px);margin-left:calc(constant(safe-area-inset-left,0) + 20px);margin-top:calc(env(safe-area-inset-top,0) + 20px);margin-right:calc(env(safe-area-inset-right,0) + 20px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 20px);margin-left:calc(env(safe-area-inset-left,0) + 20px);max-height:150px;padding:10px;right:0;background-color:#efefef}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone{max-height:66px;margin:10px;margin-top:calc(constant(safe-area-inset-top,0) + 10px);margin-right:calc(constant(safe-area-inset-right,0) + 10px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 10px);margin-left:calc(constant(safe-area-inset-left,0) + 10px);margin-top:calc(env(safe-area-inset-top,0) + 10px);margin-right:calc(env(safe-area-inset-right,0) + 10px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 10px);margin-left:calc(env(safe-area-inset-left,0) + 10px);max-width:90%;max-width:calc(100% - 40px);min-width:90%;min-width:calc(100% - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-close-button{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-close-button svg:not(.ab-chevron){display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-close-button{display:block;height:20px;padding:0 20px 0 18px;pointer-events:none;top:50%;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:12px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-close-button svg.ab-chevron{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone.ab-clickable .ab-message-text{border-right-width:40px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text{max-width:100%;border-right-width:10px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text span{max-height:66px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-message-text.ab-with-image{max-width:80%;max-width:calc(100% - 50px - 5px - 10px - 25px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-image-area{width:50px;height:50px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.simulate-phone .ab-image-area img{max-width:100%;max-height:100%;width:auto;height:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:active .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:focus .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:hover .ab-message-text{opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:active .ab-close-button svg.ab-chevron,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:focus .ab-close-button svg.ab-chevron,.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable:hover .ab-close-button svg.ab-chevron{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:table-cell;border-color:transparent;border-style:solid;border-width:5px 25px 5px 10px;max-width:430px;vertical-align:middle;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text span{display:block;max-height:150px;overflow:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-image{max-width:365px;border-top:0;border-bottom:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg.ab-chevron{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:active{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:focus{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:hover{background-color:transparent}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button:hover svg{fill-opacity:.8}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area{float:none;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:table-cell;border-color:transparent;border-style:solid;border-width:5px 0 5px 5px;vertical-align:top;width:60px;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area.ab-icon-area{width:auto}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area img{float:none;width:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message.ab-modal{font-size:14px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area{float:none;position:relative;display:block;overflow:hidden}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area .ab-center-cropped-img,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area .ab-center-cropped-img{background-size:cover;background-repeat:no-repeat;background-position:50% 50%;position:absolute;top:0;right:0;bottom:0;left:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-icon,.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-icon{margin-top:20px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic{padding:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-message-text,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-message-text{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-message-buttons,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-message-buttons{bottom:0;left:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area{float:none;height:auto;margin:0}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area img,.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area img{display:block;top:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none}.ab-iam-root.v3 .ab-in-app-message.ab-modal{padding-top:20px;width:450px;max-width:450px;max-height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-modal.simulate-phone{max-width:91%;max-width:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal.simulate-phone.graphic .ab-image-area img{max-width:91vw;max-width:calc(100vw - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text{max-height:660px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-image{max-height:524.82758621px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-icon{max-height:610px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons{margin-bottom:93px;max-height:587px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons.ab-with-image{max-height:451.82758621px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-message-text.ab-with-buttons.ab-with-icon{max-height:537px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area{margin-top:-20px;max-height:155.17241379px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area img{max-width:100%;max-height:155.17241379px}.ab-iam-root.v3 .ab-in-app-message.ab-modal .ab-image-area.ab-icon-area{height:auto}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic{width:auto;overflow:hidden}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-modal.graphic .ab-image-area img{width:auto;max-height:720px;max-width:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen{width:450px;max-height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape{width:720px;max-height:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape .ab-image-area{height:225px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape.graphic .ab-image-area{height:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape .ab-message-text{max-height:112px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-message-text{max-height:247px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-message-text.ab-with-buttons{margin-bottom:93px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area{height:360px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.graphic .ab-image-area{height:720px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone{-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone:not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone:not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.simulate-phone.graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-html-message{background-color:transparent;border:none;height:100%;overflow:auto;position:relative;touch-action:auto;width:100%}.ab-iam-root.v3 .ab-in-app-message .ab-message-buttons{position:absolute;bottom:0;width:100%;padding:17px 25px 30px 25px;z-index:inherit;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.ab-iam-root.v3 .ab-in-app-message .ab-message-button{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:5px;-moz-border-radius:5px;border-radius:5px;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;cursor:pointer;display:inline-block;font-size:14px;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;height:44px;line-height:normal;letter-spacing:normal;margin:0;max-width:100%;min-width:80px;padding:0 12px;position:relative;text-transform:none;width:48%;width:calc(50% - 5px);border:1px solid #1b78cf;-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;word-wrap:normal;white-space:nowrap}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:first-of-type{float:left;background-color:#fff;color:#1b78cf}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:last-of-type{float:right;background-color:#1b78cf;color:#fff}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:first-of-type:last-of-type{float:none;width:auto}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:transparent}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:after{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:hover{opacity:.8}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:active:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.08)}.ab-iam-root.v3 .ab-in-app-message .ab-message-button:focus:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.15)}.ab-iam-root.v3 .ab-in-app-message .ab-message-button a{color:inherit;text-decoration:inherit}.ab-iam-root.v3 .ab-in-app-message img{float:none;display:inline-block}.ab-iam-root.v3 .ab-in-app-message .ab-icon{float:none;display:inline-block;padding:10px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.ab-iam-root.v3 .ab-in-app-message .ab-icon .fa{float:none;font-size:30px;width:30px}.ab-iam-root.v3 .ab-start-hidden{visibility:hidden}.ab-iam-root.v3 .ab-centered{margin:auto;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-moz-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.ab-iam-root.v3{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}.ab-iam-root.v3 .ab-page-blocker{position:fixed;top:0;left:0;width:100%;height:100%;z-index:9001;pointer-events:all;background-color:rgba(51,51,51,.75)}@media (max-width:600px){.ab-iam-root.v3 .ab-in-app-message.ab-slideup{max-height:66px;margin:10px;margin-top:calc(constant(safe-area-inset-top,0) + 10px);margin-right:calc(constant(safe-area-inset-right,0) + 10px);margin-bottom:calc(constant(safe-area-inset-bottom,0) + 10px);margin-left:calc(constant(safe-area-inset-left,0) + 10px);margin-top:calc(env(safe-area-inset-top,0) + 10px);margin-right:calc(env(safe-area-inset-right,0) + 10px);margin-bottom:calc(env(safe-area-inset-bottom,0) + 10px);margin-left:calc(env(safe-area-inset-left,0) + 10px);max-width:90%;max-width:calc(100% - 40px);min-width:90%;min-width:calc(100% - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button{display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-close-button svg:not(.ab-chevron){display:none}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-close-button{display:block;height:20px;padding:0 20px 0 18px;pointer-events:none;top:50%;-webkit-transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%);width:12px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-close-button svg.ab-chevron{display:inline}.ab-iam-root.v3 .ab-in-app-message.ab-slideup.ab-clickable .ab-message-text{border-right-width:40px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text{max-width:100%;border-right-width:10px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text span{max-height:66px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-icon,.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-message-text.ab-with-image{max-width:80%;max-width:calc(100% - 50px - 5px - 10px - 25px)}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area{width:50px;height:50px}.ab-iam-root.v3 .ab-in-app-message.ab-slideup .ab-image-area img{max-width:100%;max-height:100%;width:auto;height:auto}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape{-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-close-button,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-message-text,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen .ab-message-text.ab-with-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape .ab-message-text.ab-with-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape:not(.graphic),.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen:not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape:not(.graphic) .ab-message-buttons,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen:not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic{display:block}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic .ab-image-area,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.graphic .ab-message-button,.ab-iam-root.v3 .ab-in-app-message:not(.force-desktop).ab-fullscreen.landscape.graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-width:480px){.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop){max-width:91%;max-width:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop).graphic .ab-image-area img{max-width:91vw;max-width:calc(100vw - 30px)}}@media (max-height:750px){.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop){max-height:91%;max-height:calc(100% - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop).graphic .ab-image-area img{max-height:91vh;max-height:calc(100vh - 30px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text{max-height:65vh;max-height:calc(100vh - 30px - 60px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-image{max-height:45vh;max-height:calc(100vh - 30px - 155.17241379310346px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-icon{max-height:45vh;max-height:calc(100vh - 30px - 70px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons{max-height:50vh;max-height:calc(100vh - 30px - 93px - 40px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons.ab-with-image{max-height:30vh;max-height:calc(100vh - 30px - 155.17241379310346px - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-modal:not(.force-desktop) .ab-message-text.ab-with-buttons.ab-with-icon{max-height:30vh;max-height:calc(100vh - 30px - 70px - 93px - 20px)}}@media (min-width:601px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen .ab-image-area img{max-height:100%;max-width:100%}}@media (max-height:750px) and (min-width:601px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important;width:450px}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen:not(.landscape):not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-height:480px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}@media (max-width:750px){.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop){-webkit-transition:top none;-moz-transition:top none;-o-transition:top none;transition:top none;top:0;right:0;bottom:0;left:0;height:100%;width:100%;max-height:none;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;-webkit-transform:none;-moz-transform:none;-ms-transform:none;transform:none;height:auto!important}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-close-button{margin-right:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-right:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0));margin-left:calc(constant(safe-area-inset-bottom,0) + constant(safe-area-inset-top,0));margin-left:calc(env(safe-area-inset-bottom,0) + env(safe-area-inset-top,0))}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-image-area,.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-image-area{height:50%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text{max-height:48%;max-height:calc(50% - 20px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop) .ab-message-text.ab-with-buttons{margin-bottom:20px;max-height:30%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).landscape .ab-message-text.ab-with-buttons{max-height:20%;max-height:calc(50% - 93px - 20px)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic){padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom,0);padding-bottom:env(safe-area-inset-bottom,0)}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop):not(.graphic) .ab-message-buttons{padding-top:0;position:relative}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic{display:block}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-image-area{height:100%}.ab-iam-root.v3 .ab-in-app-message.ab-fullscreen.landscape:not(.force-desktop).graphic .ab-message-button{margin-bottom:0;margin-bottom:constant(safe-area-inset-bottom,0);margin-bottom:env(safe-area-inset-bottom,0)}}")}function tE(e,t,a){var i=document.createElement("button");i.setAttribute("aria-label",e),i.setAttribute("tabindex","0"),i.setAttribute("role","button"),tb(i,"touchstart",()=>{}),i.className="ab-close-button";var r=tf("0 0 15 15","M15 1.5L13.5 0l-6 6-6-6L0 1.5l6 6-6 6L1.5 15l6-6 6 6 1.5-1.5-6-6 6-6z",t);return i.appendChild(r),i.addEventListener("keydown",e=>{e.keyCode!==tv.fo&&e.keyCode!==tv.co||(a(),e.stopPropagation())}),i.onclick=e=>{a(),e.stopPropagation()},i}function tD(e,t){if(isNaN(e=parseInt(e)))return"";isNaN(t=parseFloat(t))&&(t=1);var a=255&(e>>>=0),i=(65280&e)>>>8,r=(16711680&e)>>>16,s=((4278190080&e)>>>24)/255;return eo.Og()?"rgba("+[r,i,a,s*t].join(",")+")":"rgb("+[r,i,a].join(",")+")"}function tN(e){if(!eg.rr())return!1;if(!(e instanceof C||e instanceof N))return en.D.error(eY),!1;var t=e instanceof N?en.A.ro:en.A.bi;return ep.m().G(e,t).S}function tC(e){if(!eg.rr())return!1;if(!(e instanceof C))return en.D.error(eY),!1;var t=ep.m().G(e,en.A.yi);if(t){e.Cr()||tN(e);for(var a=0;a<t.ve.length;a++)t$.er().je(tw.Br,[e.triggerId],t.ve[a])}return t.S}var t_={PORTRAIT:0,LANDSCAPE:1};function tT(){return screen.width<=600}function tI(){if("orientation"in window)return 90===Math.abs(window.orientation)||270===window.orientation?t_.LANDSCAPE:t_.PORTRAIT;if("screen"in window){var e=window.screen.orientation||screen.mozOrientation||screen.msOrientation;return null!=e&&"object"==typeof e&&(e=e.type),"landscape-primary"===e||"landscape-secondary"===e?t_.LANDSCAPE:t_.PORTRAIT}return t_.PORTRAIT}function tO(e,t,a){t||null!=a&&a.metaKey?window.open(e):window.location=e}function tM(){return window.location.href}function tP(){if(eg.rr())return eg.gr()}function tR(e,t,a){if(eg.rr()){if(e6.test(e)){var i=e2(e);if(i){var r=async e=>{if(!ti(e))return void en.D.error(`Decoded Braze Action json is invalid: ${JSON.stringify(e,null,2)}`);var t=e[e1.properties.type];if(t===e1.types.ue)for(var a of e[e1.properties.me])r(a);else{var i,s=e[e1.properties.fe];switch(t){case e1.types.logCustomEvent:(await Promise.resolve().then(function(){return ey})).logCustomEvent.apply(null,Array.prototype.slice.call(s));break;case e1.types.requestPushPermission:(await Promise.resolve().then(function(){return eN})).requestPushPermission();break;case e1.types.setEmailNotificationSubscriptionType:case e1.types.setPushNotificationSubscriptionType:case e1.types.setCustomUserAttribute:case e1.types.addToSubscriptionGroup:case e1.types.removeFromSubscriptionGroup:case e1.types.addToCustomAttributeArray:case e1.types.removeFromCustomAttributeArray:(i=tP())[t].apply(i,Array.prototype.slice.call(s));break;case e1.types.de:case e1.types.pe:eb.openUri.apply(null,Array.prototype.slice.call(s));break;default:en.D.info(`Ignoring unknown Braze Action: ${t}`)}}};r(i)}}else eb.openUri(e,a,t)}}function tz(e,t,a){if(!eg.rr())return!1;if(!(e instanceof _))return en.D.error("inAppMessage argument to logInAppMessageHtmlClick must be an HtmlMessage object."),!1;var i=en.A.yi;null!=t&&(i=en.A.ji);var r=ep.m().G(e,i,t,a);if(r.S)for(var s=0;s<r.ve.length;s++)t$.er().je(tw.Br,[e.triggerId,t],r.ve[s]);return r.S}function tU(e){null==e&&(e="");var t=e.split("?").slice(1).join("?"),a={};if(null!=t)for(var i=t.split("&"),r=0;r<i.length;r++){var s=i[r].split("=");""!==s[0]&&(a[s[0]]=s[1])}return a}function tB(e){return!(!e||0!==(e=e.toString().toLowerCase()).lastIndexOf("javascript:",0)&&0!==e.lastIndexOf("data:",0))}function tL(e,t){if(!eg.rr())return!1;if(!(e instanceof T))return en.D.error("button must be an InAppMessageButton object"),!1;if(!(t instanceof C))return en.D.error(eY),!1;var a=ep.m().Ai(e,t);if(a.S)for(var i=0;i<a.ve.length;i++)t$.er().je(tw.Br,[t.triggerId,e.id],a.ve[i]);return a.S}var tF={Qe:e=>{for(var t=e.querySelectorAll(".ab-close-button, .ab-message-text, .ab-message-button"),a=0;a<t.length;a++)t[a].tabIndex=0;if(t.length>0){var i=t[0],r=t[t.length-1];e.addEventListener("keydown",t=>{var a=document.activeElement;t.keyCode!==tv.oo||(t.shiftKey||a!==r&&a!==e?t.shiftKey&&(a===i||a===e)&&(t.preventDefault(),r.focus()):(t.preventDefault(),i.focus()))})}},Ve:(e,t)=>{t.setAttribute("role","dialog"),t.setAttribute("aria-modal",!0),t.setAttribute("aria-label","Modal Message"),e&&t.setAttribute("aria-labelledby",e)},Pe:(e,t,a,i)=>{if(e.buttons.length>0){var r=document.createElement("div");r.className="ab-message-buttons",a.appendChild(r);var s=a.getElementsByClassName("ab-message-text")[0];null!=s&&(s.className+=" ab-with-buttons");for(var n=r=>s=>(e.on(a,()=>{tL(r,e),r.clickAction===C.ClickAction.URI?tR(r.uri,s,i||e.openTarget===C.OpenTarget.BLANK):r.clickAction===C.ClickAction.NEWS_FEED&&t()}),s.stopPropagation(),!1),o=0;o<e.buttons.length;o++){var l=e.buttons[o],u=document.createElement("button");u.className="ab-message-button",u.setAttribute("type","button"),tb(u,"touchstart",function(){});var h=l.text;""===l.text&&(h="\xa0"),u.appendChild(document.createTextNode(h)),e.sn()||(u.style.backgroundColor=tD(l.backgroundColor),u.style.color=tD(l.textColor),u.style.borderColor=tD(l.borderColor)),u.onclick=n(l),r.appendChild(u)}}}};function tq(e,t,a){if(eg.rr()){if(tk(),tA(),null==e)return!1;if(e instanceof N)return en.D.info("User received control for a multivariate test, logging to Braze servers."),tN(e),!0;if(!(e instanceof C))return!1;var i,r=ep.m();e.hh();var s=e instanceof _;if(s&&!e.trusted&&!eg.tr())return en.D.error('HTML in-app messages are disabled. Use the "allowUserSuppliedJavascript" option for braze.initialize to enable these messages.'),r.di(e.triggerId,C.Ge.Eh),!1;if(null==t&&(t=document.body),e.Ie()&&t.querySelectorAll(".ab-modal-interactions").length>0)return en.D.info(`Cannot show in-app message ${e.message} because another message is being shown.`),r.di(e.triggerId,C.Ge.Ee),!1;if(eb.so()){var n=eb.io();if(n===t_.PORTRAIT&&e.orientation===C.Orientation.LANDSCAPE||n===t_.LANDSCAPE&&e.orientation===C.Orientation.PORTRAIT){var o=n===t_.PORTRAIT?"portrait":"landscape",l=e.orientation===C.Orientation.PORTRAIT?"portrait":"landscape";return en.D.info(`Not showing ${l} in-app message ${e.message} because the screen is currently ${o}`),r.di(e.triggerId,C.Ge.uh),!1}}if(!eg.tr()){var u=!1;if(e.buttons&&e.buttons.length>0)for(var h=e.buttons,c=0;c<h.length;c++)h[c].clickAction===C.ClickAction.URI&&(u=tB(h[c].uri));else e.clickAction===C.ClickAction.URI&&(u=tB(e.uri));if(u)return en.D.error('Javascript click actions are disabled. Use the "allowUserSuppliedJavascript" option for braze.initialize to enable these actions.'),r.di(e.triggerId,C.Ge.Eh),!1}var d=document.createElement("div");if(d.className="ab-iam-root v3",d.className+=(i="",e.animateIn&&(i+=" ab-animate-in"),e.animateOut&&(i+=" ab-animate-out"),e instanceof I?i+=" ab-effect-fullscreen":e instanceof _?i+=" ab-effect-html":e instanceof O?i+=" ab-effect-modal":e instanceof M&&(i+=" ab-effect-slide"),i),d.setAttribute("role","complementary"),e.an()&&(d.id=e.htmlId),eg.nn(tj.no)&&(d.style.zIndex=eg.nn(tj.no)+1),t.appendChild(d),e.sn()){var p=document.createElement("style");p.innerHTML=e.css,p.id=e.rn(),null!=eg.nn(tj.ao)&&p.setAttribute("nonce",eg.nn(tj.ao)),document.getElementsByTagName("head")[0].appendChild(p)}var b=e instanceof M,m=function(e,t,a,i,r,s,n){if(e.Le=document.activeElement,e instanceof _)return function(e,t,a,i,r,s){var n=document.createElement("iframe");n.setAttribute("title","Modal Message"),r&&(n.style.zIndex=r+1);var o=t=>{var a=t.getAttribute("href"),r=t.onclick;return s=>{if(null==r||"function"!=typeof r||!1!==r()){var o=tU(a).abButtonId;if(null!=o&&""!==o||(o=t.getAttribute("id")),null!=a&&""!==a&&0!==a.indexOf("#")){var l="blank"===(t.getAttribute("target")||"").toLowerCase().replace("_",""),u=i||e.openTarget===C.OpenTarget.BLANK||l,h=()=>{tz(e,o,a),eb.openUri(a,u,s)};u?h():e.on(n,h)}else tz(e,o,a);return s.stopPropagation(),!1}}},l=(e,t,a)=>{var i=`([\\w]+)\\s*=\\s*document.createElement\\(['"]${a}['"]\\)`,r=e.match(new RegExp(i));if(r){var s=`${r[1]}.setAttribute("nonce", "${t}")`;return`${e.slice(0,r.index+r[0].length)};${s};${e.slice(r.index+r[0].length)}`}return null};if(n.onload=()=>{var i=null;if(null!=s){(i=document.createElement("html")).innerHTML=e.message;for(var r=i.getElementsByTagName("style"),u=0;u<r.length;u++)r[u].setAttribute("nonce",s);for(var h=i.getElementsByTagName("script"),c=0;c<h.length;c++){h[c].setAttribute("nonce",s),h[c].innerHTML=h[c].innerHTML.replace(/<style>/g,`<style nonce='${s}'>`);var d=l(h[c].innerHTML,s,"script");d&&(h[c].innerHTML=d);var p=l(h[c].innerHTML,s,"style");p&&(h[c].innerHTML=p)}}n.contentWindow.focus(),n.contentWindow.document.write(i?i.innerHTML:e.message);var b=n.contentWindow.document.getElementsByTagName("head")[0];if(null!=b){if(tk(b),e.sn()){var m=document.createElement("style");m.innerHTML=e.css,m.id=e.rn(),null!=s&&m.setAttribute("nonce",s),b.appendChild(m)}var g=n.contentWindow.document.createElement("base");g.setAttribute("target","_parent"),b.appendChild(g)}var f=n.contentWindow.document.getElementsByTagName("title");f.length>0&&n.setAttribute("title",f[0].textContent);var v={closeMessage:function(){e.on(n)},logClick:function(){var t=[e,...arguments];tz.apply(e,Array.prototype.slice.call(t))},display:{},web:{}},x=function(){return function(){var e=arguments;Promise.resolve().then(function(){return eN}).then(t=>{t.requestPushPermission.apply(null,Array.prototype.slice.call(e))})}},w={requestImmediateDataFlush:async function(){var e=arguments;(await Promise.resolve().then(function(){return eA})).requestImmediateDataFlush.apply(null,Array.prototype.slice.call(e))},logCustomEvent:async function(){var e=arguments;(await Promise.resolve().then(function(){return ey})).logCustomEvent.apply(null,Array.prototype.slice.call(e))},logPurchase:async function(){var e=arguments;(await Promise.resolve().then(function(){return eS})).logPurchase.apply(null,Array.prototype.slice.call(e))},unregisterPush:async function(){var e=arguments;(await Promise.resolve().then(function(){return eC})).unregisterPush.apply(null,Array.prototype.slice.call(e))},requestPushPermission:x(),changeUser:async function(){var e=arguments;(await Promise.resolve().then(function(){return ew})).changeUser.apply(null,Array.prototype.slice.call(e))}},y=function(e){return function(){w[e].apply(null,Array.prototype.slice.call(arguments))}};for(var S of eG(w))v[S]=y(S);for(var A=["setFirstName","setLastName","setEmail","setGender","setDateOfBirth","setCountry","setHomeCity","setEmailNotificationSubscriptionType","setLanguage","addAlias","setPushNotificationSubscriptionType","setPhoneNumber","setCustomUserAttribute","addToCustomAttributeArray","removeFromCustomAttributeArray","incrementCustomUserAttribute","setCustomLocationAttribute","addToSubscriptionGroup","removeFromSubscriptionGroup"],k=function(e){return function(){var t=tP();t[e].apply(t,Array.prototype.slice.call(arguments))}},E={},D=0;D<A.length;D++)E[A[D]]=k(A[D]);v.getUser=function(){return E};var N={showFeed:t},_=function(t){return function(){var a=arguments;e.on(n,function(){N[t].apply(null,Array.prototype.slice.call(a))})}};for(var T of eG(N))v.display[T]=_(T);var I={registerAppboyPushMessages:x()},O=function(e){return function(){I[e].apply(null,Array.prototype.slice.call(arguments))}};for(var M of eG(I))v.web[M]=O(M);if(n.contentWindow.appboyBridge=v,n.contentWindow.brazeBridge=v,e.un!==C.es.cn){for(var P=n.contentWindow.document.getElementsByTagName("a"),R=0;R<P.length;R++)P[R].onclick=o(P[R]);for(var z=n.contentWindow.document.getElementsByTagName("button"),U=0;U<z.length;U++)z[U].onclick=o(z[U])}var B=n.contentWindow.document.body;if(null!=B){e.an()&&(B.id=e.htmlId);var L=document.createElement("hidden");L.onclick=v.closeMessage,L.className="ab-programmatic-close-button",B.appendChild(L)}n.contentWindow.dispatchEvent(new CustomEvent("ab.BridgeReady")),-1!==n.className.indexOf("ab-start-hidden")&&(n.className=n.className.replace("ab-start-hidden",""),a(n)),document.activeElement!==n&&n.focus()},n.className="ab-in-app-message ab-start-hidden ab-html-message ab-modal-interactions",eo.OS===eQ.ln){var u=document.createElement("div");return u.className="ab-ios-scroll-wrapper",u.appendChild(n),e.mn=u,u}return e.mn=n,n}(e,t,a,r,s,n);var o=function(e,t,a,i,r,s){var n,o=document.createElement("div");o.className="ab-in-app-message ab-start-hidden ab-background",s&&(o.style.zIndex=s+1),e.Ie()&&(o.className+=" ab-modal-interactions",o.setAttribute("tabindex","-1")),e.sn()||(o.style.color=tD(e.textColor),o.style.backgroundColor=tD(e.backgroundColor),isNaN(n=parseInt(n=e.backgroundColor))||(4278190080&n)>>>24!=0||(o.className+=" ab-no-shadow"));var l=()=>{-1!==o.className.indexOf("ab-start-hidden")&&(o.className=o.className.replace("ab-start-hidden",""),document.querySelectorAll(".ab-iam-img-loading").length>0?i(`Cannot show in-app message ${e.message} because another message is being shown.`,C.Ge.Ee):a(o))};e.imageStyle===C.ImageStyle.GRAPHIC&&(o.className+=" graphic"),e.orientation===C.Orientation.LANDSCAPE&&(o.className+=" landscape"),0===e.buttons.length&&(e.clickAction!==C.ClickAction.NONE&&(o.className+=" ab-clickable"),o.onclick=a=>(e.on(o,()=>{tC(e),e.clickAction===C.ClickAction.URI?tR(e.uri,a,r||e.openTarget===C.OpenTarget.BLANK):e.clickAction===C.ClickAction.NEWS_FEED&&t()}),a.stopPropagation(),!1));var u=tE("Close Message",e.sn()?void 0:tD(e.closeButtonColor),()=>{e.on(o)});o.appendChild(u),s&&(u.style.zIndex=s+2);var h=document.createElement("div");h.className="ab-message-text";var c=(e.messageAlignment||e.He).toLowerCase();h.className+=" "+c+"-aligned";var d=!1,p=document.createElement("div");if(p.className="ab-image-area",e.imageUrl){if(e.cropType===C.CropType.CENTER_CROP){var b=document.createElement("span");b.className="ab-center-cropped-img",b.style.backgroundImage="url("+e.imageUrl+")",b.setAttribute("role","img"),b.setAttribute("aria-label","Modal Image"),e.Je(b),p.appendChild(b)}else{var m=document.createElement("img");if(m.setAttribute("src",e.imageUrl),e.Je(m),0===document.querySelectorAll(".ab-iam-img-loading").length){d=!0;var g=document.querySelectorAll(".ab-iam-root");g&&g.length>0&&g[0].classList.add("ab-iam-img-loading"),m.onload=()=>{var e=document.querySelectorAll(".ab-iam-root");e&&e.length>0&&(e[0].classList.remove("ab-iam-img-loading"),l())}}setTimeout(l,1e3),p.appendChild(m)}o.appendChild(p),h.className+=" ab-with-image"}else if(e.icon){p.className+=" ab-icon-area";var f=document.createElement("span");f.className="ab-icon",e.sn()||(f.style.backgroundColor=tD(e.iconBackgroundColor),f.style.color=tD(e.iconColor));var v=document.createElement("i");v.className="fa",v.appendChild(document.createTextNode(e.icon)),v.setAttribute("aria-hidden",!0),f.appendChild(v),p.appendChild(f),o.appendChild(p),h.className+=" ab-with-icon"}if(tb(h,"touchstart",function(){}),e.header&&e.header.length>0){var x=document.createElement("h1");x.className="ab-message-header",e.Ke=en.it.nt(),x.id=e.Ke;var w=(e.headerAlignment||C.TextAlignment.CENTER).toLowerCase();x.className+=" "+w+"-aligned",e.sn()||(x.style.color=tD(e.headerTextColor)),x.appendChild(document.createTextNode(e.header)),h.appendChild(x)}return h.appendChild(e.Oe()),o.appendChild(h),d||l(),e.mn=o,o}(e,t,a,i,r,s);if(e instanceof I||e instanceof O){var l=e instanceof I?"ab-fullscreen":"ab-modal";o.className+=` ${l} ab-centered`,em.Pe(e,t,o,r),em.Qe(o),em.Ve(e.Ke,o)}else if(e instanceof M){o.className+=" ab-slideup";var u,h,c=o.getElementsByClassName("ab-close-button")[0];if(null!=c){var d=tf("0 0 11.38 19.44","M11.38 9.72l-9.33 9.72L0 17.3l7.27-7.58L0 2.14 2.05 0l9.33 9.72z",e.sn()?void 0:tD(e.closeButtonColor));d.setAttribute("class","ab-chevron"),c.appendChild(d)}tg(o,td.ot,e=>{o.className+=" ab-swiped-left",c.onclick(e)}),tg(o,td.et,e=>{o.className+=" ab-swiped-right",c.onclick(e)}),e.slideFrom===C.SlideFrom.TOP?(u=td.We,h=" ab-swiped-up"):(u=td.Xe,h=" ab-swiped-down"),tg(o,u,e=>{o.className+=h,c.onclick(e)})}return o}(e,()=>{Promise.resolve().then(function(){return eE}).then(e=>e.showFeed())},t=>{if(e.Ie()&&e.ll()){var i=document.createElement("div");if(i.className="ab-page-blocker",e.sn()||(i.style.backgroundColor=tD(e.frameColor)),eg.nn(tj.no)&&(i.style.zIndex=eg.nn(tj.no)),d.appendChild(i),!eg.nn(tj.eh)){var r=new Date().valueOf();i.onclick=a=>{new Date().valueOf()-r>C.Ah&&(e.on(t),a.stopPropagation())}}d.appendChild(t),t.focus(),e.th(d)}else if(b){for(var n=document.querySelectorAll(".ab-slideup"),o=null,l=n.length-1;l>=0;l--)if(n[l]!==t){o=n[l];break}if(e.slideFrom===C.SlideFrom.TOP){var u=0;null!=o&&(u=o.offsetTop+o.offsetHeight),t.style.top=Math.max(u,0)+"px"}else{var h=0;null!=o&&(h=(window.innerHeight||document.documentElement.clientHeight)-o.offsetTop),t.style.bottom=Math.max(h,0)+"px"}}else s&&!eg.nn(tj.eh)&&t.contentWindow.addEventListener("keydown",function(t){t.keyCode===tv.ih&&e.closeMessage()});tN(e),e.dismissType===C.DismissType.AUTO_DISMISS&&setTimeout(()=>{d.contains(t)&&e.on(t)},e.duration),"function"==typeof a&&a()},(t,a)=>{en.D.info(t),r.di(e.triggerId,a)},eg.nn(tj.lo),eg.nn(tj.no),eg.nn(tj.ao));return(s||b)&&(d.appendChild(m),e.th(d)),!0}}function tG(e){if(eg.rr())return"function"!=typeof e?null:ep.m().mi(function(t){return e(t[0]),t.slice(1)})}var t$={t:!1,provider:null,er:()=>(t$.init(),t$.provider),rg:()=>{if(!t$.provider){var e=eg.nn(tj.So);t$.provider=new W(null!=e?e:30,ep.m().pi(),eg.l(),eg.mr(),ep.m()),eg.ar(t$.provider)}},init:()=>{t$.t||(t$.rg(),eg.u(t$),t$.t=!0)},destroy:()=>{t$.provider=null,t$.t=!1}},tj={ho:"allowCrawlerActivity",po:"baseUrl",ta:"disablePushTokenMaintenance",Io:"enableLogging",Ao:"enableSdkAuthentication",ia:"manageServiceWorkerExternally",So:"minimumIntervalBetweenTriggerActionsInSeconds",No:"sessionTimeoutInSeconds",wo:"appVersion",na:"serviceWorkerLocation",ra:"safariWebsitePushId",zn:"localization",ao:"contentSecurityNonce",To:"enableHtmlInAppMessages",Oo:"allowUserSuppliedJavascript",no:"inAppMessageZIndex",lo:"openInAppMessagesInNewTab",tn:"openCardsInNewTab",en:"openNewsFeedCardsInNewTab",eh:"requireExplicitInAppMessageDismissal",vo:"doNotLoadFontAwesome",Co:"sdkFlavor"},tH={G:(e,t,a)=>{var i=new S,r=eg.g();if(!r)return en.D.info(`Not logging event with type "${e}" because the current session ID could not be found.`),i;var s=r.mo();return i.ve.push(new p(a||eg.p().getUserId(),e,new Date().valueOf(),s,t)),i.S=eg.l().bo(i.ve),i}},tW={t:!1,i:null,m:()=>(tW.o(),tW.i||(tW.i=new X(eg.l(),eg.g(),eg.p())),tW.i),o:()=>{tW.t||(eg.u(tW),tW.t=!0)},destroy:()=>{tW.i=null,tW.t=!1}};function tJ(e,t){return!!eg.rr()&&(e instanceof r?ev.m().C(e,t).S:(en.D.error("card "+eV),!1))}function tK(e){return!!eg.rr()&&(e instanceof r?ev.m().H(e).S:(en.D.error("card "+eV),!1))}function tX(e,t){if(!eg.rr())return!1;if(!eL(e))return en.D.error("cards must be an array"),!1;for(var a of e)if(!(a instanceof r))return en.D.error(`Each card in cards ${eV}`),!1;return ev.m().M(e,t).S}function tY(e,t,a,i,u,h,c,d,p,b,m,g,f,v,x,w,y,S){var A;if(t===r.es.dt||t===r.es.Rt)A=new o(e,a,i,u,h,c,d,p,b,m,g,f,v,x,w,y);else if(t===r.es.st)A=new n(e,a,i,u,h,c,d,p,b,m,g,f,v,x,w,y);else if(t===r.es.rs)A=new s(e,a,u,c,d,p,b,m,g,f,v,x,w,y);else{if(t!==r.es._t)return en.D.error("Ignoring card with unknown type "+t),null;A=new l(e,a,d,b,v,x)}return S&&(A.test=S),A}function tV(e){if(null!=e){var t=e.querySelectorAll(".ab-unread-indicator")[0];null!=t&&(t.className+=" read")}}var tZ={en:{NO_CARDS_MESSAGE:"We have no updates for you at this time.<br/>Please check again later.",FEED_TIMEOUT_MESSAGE:"Sorry, this refresh timed out.<br/>Please try again later."},ar:{NO_CARDS_MESSAGE:"   .     ",FEED_TIMEOUT_MESSAGE:"   "},cs:{NO_CARDS_MESSAGE:"V tuto chv\xedli pro v\xe1s nem\xe1me \xe1dn\xe9 aktualizace.<br/>Zkontrolujte pros\xedm znovu pozdji.",FEED_TIMEOUT_MESSAGE:"Pros\xedm zkuste to znovu pozdji."},da:{NO_CARDS_MESSAGE:"Vi har ingen updates.<br/>Pr\xf8v venligst senere.",FEED_TIMEOUT_MESSAGE:"Pr\xf8v venligst senere."},de:{NO_CARDS_MESSAGE:"Derzeit sind keine Updates verf\xfcgbar.<br/>Bitte sp\xe4ter noch einmal versuchen.",FEED_TIMEOUT_MESSAGE:"Bitte sp\xe4ter noch einmal versuchen."},es:{NO_CARDS_MESSAGE:"No tenemos actualizaciones.<br/>Por favor compru\xe9belo m\xe1s tarde.",FEED_TIMEOUT_MESSAGE:"Por favor int\xe9ntelo m\xe1s tarde."},"es-mx":{NO_CARDS_MESSAGE:"No tenemos ninguna actualizaci\xf3n.<br/>Vuelva a verificar m\xe1s tarde.",FEED_TIMEOUT_MESSAGE:"Por favor, vuelva a intentarlo m\xe1s tarde."},et:{NO_CARDS_MESSAGE:"Uuendusi pole praegu saadaval.<br/>Proovige hiljem uuesti.",FEED_TIMEOUT_MESSAGE:"Palun proovige hiljem uuesti."},fi:{NO_CARDS_MESSAGE:"P\xe4ivityksi\xe4 ei ole saatavilla.<br/>Tarkista my\xf6hemmin uudelleen.",FEED_TIMEOUT_MESSAGE:"Yrit\xe4 my\xf6hemmin uudelleen."},fr:{NO_CARDS_MESSAGE:"Aucune mise \xe0 jour disponible.<br/>Veuillez v\xe9rifier ult\xe9rieurement.",FEED_TIMEOUT_MESSAGE:"Veuillez r\xe9essayer ult\xe9rieurement."},he:{NO_CARDS_MESSAGE:".  .    ",FEED_TIMEOUT_MESSAGE:".   "},hi:{NO_CARDS_MESSAGE:"            .",FEED_TIMEOUT_MESSAGE:"     ."},id:{NO_CARDS_MESSAGE:"Kami tidak memiliki pembaruan. Coba lagi nanti.",FEED_TIMEOUT_MESSAGE:"Coba lagi nanti."},it:{NO_CARDS_MESSAGE:"Non ci sono aggiornamenti.<br/>Ricontrollare pi\xf9 tardi.",FEED_TIMEOUT_MESSAGE:"Riprovare pi\xf9 tardi."},ja:{NO_CARDS_MESSAGE:"<br/>",FEED_TIMEOUT_MESSAGE:""},ko:{NO_CARDS_MESSAGE:" .    .",FEED_TIMEOUT_MESSAGE:"   ."},ms:{NO_CARDS_MESSAGE:"Tiada kemas kini. Sila periksa kemudian.",FEED_TIMEOUT_MESSAGE:"Sila cuba kemudian."},nl:{NO_CARDS_MESSAGE:"Er zijn geen updates.<br/>Probeer het later opnieuw.",FEED_TIMEOUT_MESSAGE:"Probeer het later opnieuw."},no:{NO_CARDS_MESSAGE:"Vi har ingen oppdateringer.<br/>Vennligst sjekk igjen senere.",FEED_TIMEOUT_MESSAGE:"Vennligst pr\xf8v igjen senere."},pl:{NO_CARDS_MESSAGE:"Brak aktualizacji.<br/>Prosz sprawdzi ponownie p\xf3niej.",FEED_TIMEOUT_MESSAGE:"Prosz spr\xf3bowa ponownie p\xf3niej."},pt:{NO_CARDS_MESSAGE:"N\xe3o temos atualiza\xe7\xf5es.<br/>Por favor, verifique mais tarde.",FEED_TIMEOUT_MESSAGE:"Por favor, tente mais tarde."},"pt-br":{NO_CARDS_MESSAGE:"N\xe3o temos nenhuma atualiza\xe7\xe3o.<br/>Verifique novamente mais tarde.",FEED_TIMEOUT_MESSAGE:"Tente novamente mais tarde."},ru:{NO_CARDS_MESSAGE:" .<br/>,   .",FEED_TIMEOUT_MESSAGE:",   ."},sv:{NO_CARDS_MESSAGE:"Det finns inga uppdateringar.<br/>F\xf6rs\xf6k igen senare.",FEED_TIMEOUT_MESSAGE:"F\xf6rs\xf6k igen senare."},th:{NO_CARDS_MESSAGE:" .",FEED_TIMEOUT_MESSAGE:"."},uk:{NO_CARDS_MESSAGE:" .<br/>,   .",FEED_TIMEOUT_MESSAGE:" ,    ."},vi:{NO_CARDS_MESSAGE:"Ch\xfang t\xf4i kh\xf4ng c\xf3 cp nht n\xe0o.<br/>Vui l\xf2ng kim tra li sau.",FEED_TIMEOUT_MESSAGE:"Vui l\xf2ng th li sau."},"zh-hk":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-hans":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-hant":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},"zh-tw":{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."},zh:{NO_CARDS_MESSAGE:".<br/>.",FEED_TIMEOUT_MESSAGE:"."}},tQ={t:!1,i:null,m:()=>{if(tQ.o(),!tQ.i){var e=eo.language,t=!1;eg.nn(tj.zn)&&(e=eg.nn(tj.zn),t=!0),tQ.i=new V(e,t)}return tQ.i},o:()=>{tQ.t||(eg.u(tQ),tQ.t=!0)},destroy:()=>{tQ.i=null,tQ.t=!1}};function t0(e){eg.rr()&&eg.removeSubscription(e)}function t1(e){e&&(e.className=e.className.replace("ab-show","ab-hide"),setTimeout(()=>{e&&e.parentNode&&e.parentNode.removeChild(e)},Y.Zi));var t=e.getAttribute("data-update-subscription-id");null!=t&&t0(t)}function t3(e,t){var a=document.createElement("div");if(a.className="ab-feed-body",a.setAttribute("aria-label","Feed"),a.setAttribute("role","feed"),null==e.lastUpdated){var i=document.createElement("div");i.className="ab-no-cards-message";var r=document.createElement("i");r.className="fa fa-spinner fa-spin fa-4x ab-initial-spinner",i.appendChild(r),a.appendChild(i)}else{var s=!1,n=t=>{e.logCardClick(t)};for(var o of e.cards){var u=o instanceof l;!u||e.dr()?(a.appendChild(function(e,t,a){var i=document.createElement("div");i.className="ab-card ab-effect-card "+e.Y,i.setAttribute("data-ab-card-id",e.id),i.setAttribute("role","article"),i.setAttribute("tabindex","0");var r=e.url&&""!==e.url,s=s=>(tV(i),r&&(t(e),tR(e.url,s,a)),!1);if(e.pinned){var n=document.createElement("div");n.className="ab-pinned-indicator";var o=document.createElement("i");o.className="fa fa-star",n.appendChild(o),i.appendChild(n)}if(e.imageUrl&&""!==e.imageUrl){var l,u=document.createElement("div");u.className="ab-image-area";var h=document.createElement("img");if(h.setAttribute("src",e.imageUrl),h.onload=()=>{i.style.height="auto"},l="",e.title||e.description||(l="Feed Image"),h.setAttribute("alt",l),u.appendChild(h),i.className+=" with-image",r&&!e.Z){var c=document.createElement("a");c.setAttribute("href",e.url),c.onclick=s,c.appendChild(u),i.appendChild(c)}else i.appendChild(u)}var d=document.createElement("div");if(d.className="ab-card-body",e.dismissible){e.tt=()=>tK(e);var p=tE("Dismiss Card",void 0,e.dismissCard.bind(e));i.appendChild(p),tg(d,td.ot,e=>{i.className+=" ab-swiped-left",p.onclick(e)}),tg(d,td.et,e=>{i.className+=" ab-swiped-right",p.onclick(e)})}var b=e.title&&""!==e.title;if(b){var m=document.createElement("h1");if(m.className="ab-title",m.id=en.it.nt(),i.setAttribute("aria-labelledby",m.id),r){var g=document.createElement("a");g.setAttribute("href",e.url),g.onclick=s,g.appendChild(document.createTextNode(e.title)),m.appendChild(g)}else m.appendChild(document.createTextNode(e.title));d.appendChild(m)}var f=document.createElement("div");if(f.className=b?"ab-description":"ab-description ab-no-title",f.id=en.it.nt(),i.setAttribute("aria-describedby",f.id),f.appendChild(document.createTextNode(e.description)),r){var v=document.createElement("div");v.className="ab-url-area";var x=document.createElement("a");x.setAttribute("href",e.url),x.appendChild(document.createTextNode(e.linkText)),x.onclick=s,v.appendChild(x),f.appendChild(v)}d.appendChild(f),i.appendChild(d);var w=document.createElement("div");return w.className="ab-unread-indicator",e.viewed&&(w.className+=" read"),i.appendChild(w),e.X=i,i}(o,n,t)),s=s||!u):en.D.error("Received a control card for a legacy news feed. Control cards are only supported with content cards.")}if(!s){var h=document.createElement("div");h.className="ab-no-cards-message",h.innerHTML=ex.m().get("NO_CARDS_MESSAGE"),h.setAttribute("role","article"),a.appendChild(h)}}return a}function t5(e,t){if(null!=t){var a=[],i=t.querySelectorAll(".ab-card");e.do||(e.do={});for(var r=0;r<i.length;r++){var s=i[r].getAttribute("data-ab-card-id");if(!e.do[s]){var n,o,l,u,h,c,d=null!=(n=i[r])&&!!n.getAttribute("data-ab-had-top-impression"),p=null!=(o=i[r])&&!!o.getAttribute("data-ab-had-bottom-impression"),b=d,m=p,g=(l=i[r],ed.eo(l,!0,!1,!1)),f=(u=i[r],ed.eo(u,!1,!0,!1));if(!d&&g&&(d=!0,null!=(h=i[r])&&h.setAttribute("data-ab-had-top-impression",!0)),!p&&f&&(p=!0,null!=(c=i[r])&&c.setAttribute("data-ab-had-bottom-impression",!0)),d&&p){if(g||f||tV(i[r]),b&&m)continue;for(var v of e.cards)if(v.id===s){e.do[v.id]=!0,a.push(v);break}}}}a.length>0&&e.logCardImpressions(a)}}function t2(e,t){t.setAttribute("aria-busy","true");var a=t.querySelectorAll(".ab-refresh-button")[0];null!=a&&(a.className+=" fa-spin");var i=new Date().valueOf().toString();t.setAttribute("data-last-requested-refresh",i),setTimeout(()=>{if(t.getAttribute("data-last-requested-refresh")===i){for(var e=t.querySelectorAll(".fa-spin"),a=0;a<e.length;a++)e[a].className=e[a].className.replace(/fa-spin/g,"");var r=t.querySelectorAll(".ab-initial-spinner")[0];if(null!=r){var s=document.createElement("span");s.innerHTML=ex.m().get("FEED_TIMEOUT_MESSAGE"),r.parentNode.appendChild(s),r.parentNode.removeChild(r)}"true"===t.getAttribute("aria-busy")&&t.setAttribute("aria-busy","false")}},Y.uo),e.sr()}function t4(e,t,a,i,s){if(eL(t)){var n=[];for(var o of t)if(o instanceof r){if(o.url&&e6.test(o.url)&&e8(e2(o.url))){en.D.error(e5(e3.Di,"Content Card"));continue}n.push(o)}if(e.cards=n,e.lastUpdated=a,null!=i){if(i.setAttribute("aria-busy","false"),null==e.lastUpdated)t1(i);else{var l=i.querySelectorAll(".ab-feed-body")[0];if(null!=l){var u=t3(e,s);l.parentNode.replaceChild(u,l),t5(e,u.parentNode)}}}}}function t8(e,t){return!!eg.rr()&&(null==e||0===e.length||e!=e?(en.D.error("changeUser requires a non-empty userId."),!1):e0(e)>m.ee?(en.D.error(`Rejected user id "${e}" because it is longer than ${m.ee} bytes.`),!1):!(null!=t&&!te(t,"set signature for new user","signature"))&&void eg.mr().changeUser(e.toString(),eg.re(),t))}function t7(){en.D.info("Destroying Braze instance"),eg.destroy(!0)}function t6(e,t){return eg.initialize(e,t)}function t9(e,t){if(!eg.rr())return!1;if(null==e||e.length<=0)return en.D.error(`logCustomEvent requires a non-empty eventName, got "${e}". Ignoring event.`),!1;if(!tt(e,"log custom event","the event name"))return!1;var[a,i]=ta(t,"logCustomEvent","eventProperties",`log custom event "${e}"`,"event");if(!a)return!1;if(eg.ir().ge(e))return en.D.info(`Custom Event "${e}" is blocklisted, ignoring.`),!1;var r=ef.G(en.A.CustomEvent,{n:e,p:i});if(r.S)for(var s of(en.D.info(`Logged custom event "${e}".`),r.ve))t$.er().je(tw.be,[e,t],s);return r.S}function ae(e,t,a,i,r){if(!eg.rr())return!1;if(null==a&&(a="USD"),null==i&&(i=1),null==e||e.length<=0)return en.D.error(`logPurchase requires a non-empty productId, got "${e}", ignoring.`),!1;if(!tt(e,"log purchase","the purchase name"))return!1;var s=parseFloat(t);if(isNaN(s))return en.D.error(`logPurchase requires a numeric price, got ${t}, ignoring.`),!1;s=s.toFixed(2);var n=parseInt(i);if(isNaN(n))return en.D.error(`logPurchase requires an integer quantity, got ${i}, ignoring.`),!1;if(n<1||n>100)return en.D.error(`logPurchase requires a quantity >1 and <100, got ${n}, ignoring.`),!1;if(-1===["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BRL","BSD","BTC","BTN","BWP","BYR","BZD","CAD","CDF","CHF","CLF","CLP","CNY","COP","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EEK","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GGP","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","IMP","INR","IQD","IRR","ISK","JEP","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LTL","LVL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRO","MTL","MUR","MVR","MWK","MXN","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","STD","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","UYU","UZS","VEF","VND","VUV","WST","XAF","XAG","XAU","XCD","XDR","XOF","XPD","XPF","XPT","YER","ZAR","ZMK","ZMW","ZWL"].indexOf(a=a.toUpperCase()))return en.D.error(`logPurchase requires a valid currencyCode, got ${a}, ignoring.`),!1;var[o,l]=ta(r,"logPurchase","purchaseProperties",`log purchase "${e}"`,"purchase");if(!o)return!1;if(eg.ir().Dr(e))return en.D.info(`Purchase "${e}" is blocklisted, ignoring.`),!1;var u=ef.G(en.A.Pr,{pid:e,c:a,p:s,q:n,pr:l});if(u.S)for(var h of(en.D.info(`Logged ${n} purchase${n>1?"s":""} of "${e}" for ${a} ${s}.`),u.ve))t$.er().je(tw.Rr,[e,r],h);return u.S}function at(){if(eg.rr()){eg.mr().openSession();var e=en.xt.Ft,t=new en.qt(e,en.D);t.hr(e.$t.jr,function(a,i){var r=i.lastClick,s=i.trackingString;en.D.info(`Firing push click trigger from ${s} push click at ${r}`);var n=eg.mr().kr(r,s),o=function(){t$.er().je(tw.vr,[s],n)};eg.mr().zr(o,o),t.br(e.$t.jr,a)}),t.Jt(e.$t.$r,function(e){eg.mr().wr(e)})}}function aa(e){eg.rr()&&eg.mr().requestImmediateDataFlush(e)}var ai={t:!1,provider:null,er:()=>(ai.o(),ai.provider||(ai.provider=new Z(eg.l(),eg.mr()),eg.ar(ai.provider)),ai.provider),o:()=>{ai.t||(eg.u(ai),ai.t=!0)},destroy:()=>{ai.provider=null,ai.t=!1}};function ar(){if(eg.rr())return ek.er().Is()}function as(){if(eg.rr())return eg.nr().Fr(en.Ar.qr).S}function an(e,t,a){if(eg.rr()){tS(void 0,"feed","body>.ab-feed{position:fixed;top:0;right:0;bottom:0;width:421px;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0}body>.ab-feed .ab-feed-body{position:absolute;top:0;left:0;right:0;border:none;border-left:1px solid #d0d0d0;padding-top:70px;min-height:100%}body>.ab-feed .ab-initial-spinner{float:none}body>.ab-feed .ab-no-cards-message{position:absolute;width:100%;margin-left:-20px;top:40%}.ab-feed{-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 1px 7px 1px rgba(66,82,113,.15);-moz-box-shadow:0 1px 7px 1px rgba(66,82,113,.15);box-shadow:0 1px 7px 1px rgba(66,82,113,.15);width:402px;background-color:#eee;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;font-size:13px;line-height:130%;letter-spacing:normal;overflow-y:auto;overflow-x:visible;z-index:9011;-webkit-overflow-scrolling:touch}.ab-feed :focus,.ab-feed:focus{outline:0}.ab-feed .ab-feed-body{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:1px solid #d0d0d0;border-top:none;padding:20px 20px 0 20px}.ab-feed.ab-effect-slide{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px);-webkit-transition:transform .5s ease-in-out;-moz-transition:transform .5s ease-in-out;-o-transition:transform .5s ease-in-out;transition:transform .5s ease-in-out}.ab-feed.ab-effect-slide.ab-show{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}.ab-feed.ab-effect-slide.ab-hide{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px)}.ab-feed .ab-card{position:relative;-webkit-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-moz-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;width:100%;border:1px solid #d0d0d0;margin-bottom:20px;overflow:hidden;background-color:#fff;-webkit-transition:height .4s ease-in-out,margin .4s ease-in-out;-moz-transition:height .4s ease-in-out,margin .4s ease-in-out;-o-transition:height .4s ease-in-out,margin .4s ease-in-out;transition:height .4s ease-in-out,margin .4s ease-in-out}.ab-feed .ab-card .ab-pinned-indicator{position:absolute;right:0;top:0;margin-right:-1px;width:0;height:0;border-style:solid;border-width:0 24px 24px 0;border-color:transparent #1676d0 transparent transparent}.ab-feed .ab-card .ab-pinned-indicator .fa-star{position:absolute;right:-21px;top:2px;font-size:9px;color:#fff}.ab-feed .ab-card.ab-effect-card.ab-hide{-webkit-transition:all .5s ease-in-out;-moz-transition:all .5s ease-in-out;-o-transition:all .5s ease-in-out;transition:all .5s ease-in-out}.ab-feed .ab-card.ab-effect-card.ab-hide.ab-swiped-left{-webkit-transform:translateX(-450px);-moz-transform:translateX(-450px);-ms-transform:translateX(-450px);transform:translateX(-450px)}.ab-feed .ab-card.ab-effect-card.ab-hide.ab-swiped-right{-webkit-transform:translateX(450px);-moz-transform:translateX(450px);-ms-transform:translateX(450px);transform:translateX(450px)}.ab-feed .ab-card.ab-effect-card.ab-hide:not(.ab-swiped-left):not(.ab-swiped-right){opacity:0}.ab-feed .ab-card .ab-close-button{-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;background-color:transparent;background-size:15px;border:none;width:15px;min-width:15px;height:15px;cursor:pointer;display:block;font-size:15px;line-height:0;padding-top:15px;padding-right:15px;padding-left:15px;padding-bottom:15px;position:absolute;right:0;top:0;z-index:9021;opacity:0;-webkit-transition:.5s;-moz-transition:.5s;-o-transition:.5s;transition:.5s}.ab-feed .ab-card .ab-close-button svg{-webkit-transition:.2s ease;-moz-transition:.2s ease;-o-transition:.2s ease;transition:.2s ease;fill:#9b9b9b;height:auto;width:100%}.ab-feed .ab-card .ab-close-button svg.ab-chevron{display:none}.ab-feed .ab-card .ab-close-button:active{background-color:transparent}.ab-feed .ab-card .ab-close-button:focus{background-color:transparent}.ab-feed .ab-card .ab-close-button:hover{background-color:transparent}.ab-feed .ab-card .ab-close-button:hover svg{fill-opacity:.8}.ab-feed .ab-card .ab-close-button:hover{opacity:1}.ab-feed .ab-card .ab-close-button:focus{opacity:1}.ab-feed .ab-card a{float:none;color:inherit;text-decoration:none}.ab-feed .ab-card a:hover{text-decoration:underline}.ab-feed .ab-card .ab-image-area{float:none;display:inline-block;vertical-align:top;line-height:0;overflow:hidden;width:100%;-webkit-box-sizing:initial;-moz-box-sizing:initial;box-sizing:initial}.ab-feed .ab-card .ab-image-area img{float:none;height:auto;width:100%}.ab-feed .ab-card.ab-banner .ab-card-body{display:none}.ab-feed .ab-card .ab-card-body{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:inline-block;width:100%;position:relative}.ab-feed .ab-card .ab-unread-indicator{position:absolute;bottom:0;margin-right:-1px;width:100%;height:5px;background-color:#1676d0}.ab-feed .ab-card .ab-unread-indicator.read{background-color:transparent}.ab-feed .ab-card .ab-title{float:none;letter-spacing:0;margin:0;font-weight:700;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif;display:block;overflow:hidden;word-wrap:break-word;text-overflow:ellipsis;font-size:18px;line-height:130%;padding:20px 25px 0 25px}.ab-feed .ab-card .ab-description{float:none;color:#545454;padding:15px 25px 20px 25px;word-wrap:break-word;white-space:pre-wrap}.ab-feed .ab-card .ab-description.ab-no-title{padding-top:20px}.ab-feed .ab-card .ab-url-area{float:none;color:#1676d0;margin-top:12px;font-family:'Helvetica Neue Light','Helvetica Neue',Helvetica,Arial,'Lucida Grande',sans-serif}.ab-feed .ab-card.ab-classic-card .ab-card-body{min-height:40px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px}.ab-feed .ab-card.ab-classic-card.with-image .ab-card-body{min-height:100px;padding-left:72px}.ab-feed .ab-card.ab-classic-card.with-image .ab-image-area{width:60px;height:60px;padding:20px 0 25px 25px;position:absolute}.ab-feed .ab-card.ab-classic-card.with-image .ab-image-area img{-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;max-width:100%;max-height:100%;width:auto;height:auto}.ab-feed .ab-card.ab-classic-card.with-image .ab-title{background-color:transparent;font-size:16px}.ab-feed .ab-card.ab-classic-card.with-image .ab-description{padding-top:10px}.ab-feed .ab-card.ab-control-card{height:0;width:0;margin:0;border:0}.ab-feed .ab-feed-buttons-wrapper{float:none;position:relative;background-color:#282828;height:50px;-webkit-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);-moz-box-shadow:0 2px 3px 0 rgba(178,178,178,.5);box-shadow:0 2px 3px 0 rgba(178,178,178,.5);z-index:1}.ab-feed .ab-feed-buttons-wrapper .ab-close-button,.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button{float:none;cursor:pointer;color:#fff;font-size:18px;padding:16px;-webkit-transition:.2s;-moz-transition:.2s;-o-transition:.2s;transition:.2s}.ab-feed .ab-feed-buttons-wrapper .ab-close-button:hover,.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button:hover{font-size:22px}.ab-feed .ab-feed-buttons-wrapper .ab-close-button{float:right}.ab-feed .ab-feed-buttons-wrapper .ab-close-button:hover{padding-top:12px;padding-right:14px}.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button{padding-left:17px}.ab-feed .ab-feed-buttons-wrapper .ab-refresh-button:hover{padding-top:13px;padding-left:14px}.ab-feed .ab-no-cards-message{text-align:center;margin-bottom:20px}@media (max-width:600px){body>.ab-feed{width:100%}}"),tA();var i,r,s,n,o,l,u,h,c=(e,t)=>{if(null==t)return e;for(var a=[],i=0;i<t.length;i++)a.push(t[i].toLowerCase());for(var r=[],s=0;s<e.length;s++){for(var n=[],o=0;o<e[s].categories.length;o++)n.push(e[s].categories[o].toLowerCase());(function(e){null==e&&(e=[]);for(var t=[],a=arguments.length,i=0,r=e.length;i<r;i++){var s=e[i];if(-1===t.indexOf(s)){var n=1;for(n=1;n<a&&-1!==arguments[n].indexOf(s);n++);n===a&&t.push(s)}}return t})(n,a).length>0&&r.push(e[s])}return r},d=eg.nn(tj.tn)||eg.nn(tj.en)||!1,p=!1;null==e&&(e=document.body,p=!0);var b=!1,m=null;null==t?(t4(m=ek.er().ai(),c(m.cards,a),m.lastUpdated,null,d),b=!0):m=new Q(c(t,a),new Date);var g=(i=m,(r=document.createElement("div")).className="ab-feed ab-hide ab-effect-slide",r.setAttribute("role","dialog"),r.setAttribute("aria-label","Feed"),r.setAttribute("tabindex","-1"),(s=document.createElement("div")).className="ab-feed-buttons-wrapper",s.setAttribute("role","group"),r.appendChild(s),(n=document.createElement("i")).className="fa fa-times ab-close-button",n.setAttribute("aria-label","Close Feed"),n.setAttribute("tabindex","0"),n.setAttribute("role","button"),o=e=>{t1(r),e.stopPropagation()},n.addEventListener("keydown",e=>{e.keyCode!==tv.fo&&e.keyCode!==tv.co||o(e)}),n.onclick=o,(l=document.createElement("i")).className="fa fa-refresh ab-refresh-button",null==i.lastUpdated&&(l.className+=" fa-spin"),l.setAttribute("aria-label","Refresh Feed"),l.setAttribute("tabindex","0"),l.setAttribute("role","button"),u=e=>{t2(i,r),e.stopPropagation()},l.addEventListener("keydown",e=>{e.keyCode!==tv.fo&&e.keyCode!==tv.co||u(e)}),l.onclick=u,s.appendChild(l),s.appendChild(n),r.appendChild(t3(i,d)),r.onscroll=()=>{t5(i,r)},r);if(b){(null==m.lastUpdated||new Date().valueOf()-m.lastUpdated.valueOf()>Q.ur)&&(en.D.info(`Cached feed was older than max TTL of ${Q.ur} ms, requesting an update from the server.`),t2(m,g));var f=new Date().valueOf();!function(e,t){t.setAttribute("data-update-subscription-id",e)}(ao(function(e){var t=g.querySelectorAll(".ab-refresh-button")[0];if(null!=t){var i=500,r=parseInt(g.getAttribute("data-last-requested-refresh"));isNaN(r)?i-=new Date().valueOf()-f:i-=new Date().valueOf()-r,setTimeout(function(){t.className=t.className.replace(/fa-spin/g,"")},Math.max(i,0))}t4(m,c(e.cards,a),e.lastUpdated,g,d)}),g)}var v=e=>{for(var t=e.querySelectorAll(".ab-feed"),a=null,i=0;i<t.length;i++)t[i].parentNode===e&&(a=t[i]);null!=a?(t1(a),a.parentNode.replaceChild(g,a)):e.appendChild(g),setTimeout(function(){g.className=g.className.replace("ab-hide","ab-show")},0),p&&g.focus(),as(),t5(m,g),function(e,t){var a,i=t.querySelectorAll(".ab-image-area"),r=0;for(var s of(i.length>0&&(r=i[0].offsetWidth),e))if((a=s.X)&&s.imageUrl&&!isNaN(s.aspectRatio)){var n=r/s.aspectRatio;n&&(a.style.height=`${n}px`)}}(m.cards,e)};null!=e?v(e):window.onload=(h=window.onload,function(){"function"==typeof h&&h(),v(document.body)})}}function ao(e){if(eg.rr())return ek.er().Ws(e)}var al={t:!1,pushManager:null,aa:()=>(al.o(),al.pushManager||(al.pushManager=new ee(eg.gr(),eg.ea(),eg.ce(),eg.Ks(),eg.nn(tj.na),eg.nn(tj.ra),eg.ir(),eg.nn(tj.ta),eg.nn(tj.ia),eg.l())),al.pushManager),o:()=>{al.t||(eg.u(al),al.t=!0)},destroy:()=>{al.pushManager=null,al.t=!1}};function au(e,t){if(eg.rr())return al.aa().subscribe((t,a,i)=>{eg.mr().requestImmediateDataFlush(),"function"==typeof e&&e(t,a,i)},t)}function ah(e,t){if(eg.rr())return al.aa().unsubscribe(e,t)}var ac={t:!1,provider:null,er:()=>(ac.o(),ac.provider||(ac.provider=new ea(eg.ir(),eg.nr(),eg.l()),eg.ar(ac.provider)),ac.provider),o:()=>{ac.t||(eg.u(ac),ac.t=!0)},destroy:()=>{ac.provider=null,ac.t=!1}};function ad(e,t,a){if(eg.rr())return e_.er().refreshFeatureFlags(e,t,a)}function ap(e,t){ad(e,t)}return e({changeUser:t8,destroy:t7,getUser:tP,initialize:t6,logCardClick:tJ,logCardDismissal:tK,logCardImpressions:tX,logCustomEvent:t9,logFeedDisplayed:as,logInAppMessageButtonClick:tL,logInAppMessageClick:tC,logInAppMessageHtmlClick:tz,logInAppMessageImpression:tN,logPurchase:ae,openSession:at,refreshFeatureFlags:ap,removeSubscription:t0,requestFeedRefresh:ar,requestImmediateDataFlush:aa,requestPushPermission:au,showFeed:an,showInAppMessage:tq,subscribeToFeedUpdates:ao,subscribeToInAppMessage:tG,unregisterPush:ah}),[()=>{ei=eI,er=eP,(a=class{constructor(e,t){this.td="undefined"==typeof window?self:window,this.ed=e,this.nd=t}od(){if("indexedDB"in this.td)return this.td.indexedDB}rd(){try{if(null==this.od())return!1;var e=this.od().open("Braze IndexedDB Support Test");if(e.onupgradeneeded=()=>e.result.close(),e.onsuccess=()=>e.result.close(),"undefined"!=typeof window){var t=window.chrome||window.browser||window.msBrowser;if(t&&t.runtime&&t.runtime.id)return this.nd.info("Not using IndexedDB for storage because we are running inside an extension"),!1}return!0}catch(e){return this.nd.info("Not using IndexedDB for storage due to following error: "+e),!1}}sd(e,t){var a=this.od().open(this.ed.dd,this.ed.VERSION);if(null==a)return"function"==typeof t&&t(),!1;var i=this;return a.onupgradeneeded=e=>{i.nd.info("Upgrading indexedDB "+i.ed.dd+" to v"+i.ed.VERSION+"...");var t=e.target.result;for(var a in i.ed.$t)i.ed.$t.hasOwnProperty(a)&&!t.objectStoreNames.contains(i.ed.$t[a])&&t.createObjectStore(i.ed.$t[a])},a.onsuccess=a=>{var r=a.target.result;r.onversionchange=()=>{r.close(),"function"==typeof t&&t(),i.nd.error("Needed to close the database unexpectedly because of an upgrade in another tab")},e(r)},a.onerror=e=>(i.nd.info("Could not open indexedDB "+i.ed.dd+" v"+i.ed.VERSION+": "+e.target.errorCode),"function"==typeof t&&t(),!0),!0}setItem(e,t,a,i,r){if(!this.rd())return"function"==typeof r&&r(),!1;var s=this;return this.sd(n=>{if(!n.objectStoreNames.contains(e))return s.nd.error("Could not store object "+t+" in "+e+" on indexedDB "+s.ed.dd+" - "+e+" is not a valid objectStore"),"function"==typeof r&&r(),void n.close();var o=n.transaction([e],"readwrite");o.oncomplete=()=>n.close();var l=o.objectStore(e).put(a,t);l.onerror=()=>{s.nd.error("Could not store object "+t+" in "+e+" on indexedDB "+s.ed.dd),"function"==typeof r&&r()},l.onsuccess=()=>{"function"==typeof i&&i()}},r)}getItem(e,t,a){if(!this.rd())return!1;var i=this;return this.sd(r=>{if(!r.objectStoreNames.contains(e))return i.nd.error("Could not retrieve object "+t+" in "+e+" on indexedDB "+i.ed.dd+" - "+e+" is not a valid objectStore"),void r.close();var s=r.transaction([e],"readonly");s.oncomplete=()=>r.close();var n=s.objectStore(e).get(t);n.onerror=()=>{i.nd.error("Could not retrieve object "+t+" in "+e+" on indexedDB "+i.ed.dd)},n.onsuccess=e=>{var t=e.target.result;null!=t&&a(t)}})}hr(e,t,a){if(!this.rd())return"function"==typeof a&&a(),!1;var i=this;return this.sd(r=>{if(!r.objectStoreNames.contains(e))return i.nd.error("Could not retrieve last record from "+e+" on indexedDB "+i.ed.dd+" - "+e+" is not a valid objectStore"),"function"==typeof a&&a(),void r.close();var s=r.transaction([e],"readonly");s.oncomplete=()=>r.close();var n=s.objectStore(e).openCursor(null,"prev");n.onerror=()=>{i.nd.error("Could not open cursor for "+e+" on indexedDB "+i.ed.dd),"function"==typeof a&&a()},n.onsuccess=e=>{var i=e.target.result;null!=i&&null!=i.value&&null!=i.key?t(i.key,i.value):"function"==typeof a&&a()}},a)}br(e,t){if(!this.rd())return!1;var a=this;return this.sd(i=>{if(!i.objectStoreNames.contains(e))return a.nd.error("Could not delete record "+t+" from "+e+" on indexedDB "+a.ed.dd+" - "+e+" is not a valid objectStore"),void i.close();var r=i.transaction([e],"readwrite");r.oncomplete=()=>i.close(),r.objectStore(e).delete(t).onerror=()=>{a.nd.error("Could not delete record "+t+" from "+e+" on indexedDB "+a.ed.dd)}})}Jt(e,t){if(!this.rd())return!1;var a=this;return this.sd(i=>{if(!i.objectStoreNames.contains(e))return a.nd.error("Could not retrieve objects from "+e+" on indexedDB "+a.ed.dd+" - "+e+" is not a valid objectStore"),void i.close();var r=i.transaction([e],"readwrite");r.oncomplete=()=>i.close();var s=r.objectStore(e),n=s.openCursor(),o=[];n.onerror=()=>{o.length>0?(a.nd.info("Cursor closed midway through for "+e+" on indexedDB "+a.ed.dd),t(o)):a.nd.error("Could not open cursor for "+e+" on indexedDB "+a.ed.dd)},n.onsuccess=e=>{var a=e.target.result;null!=a?(null!=a.value&&null!=a.key&&(s.delete(a.key).onsuccess=()=>{o.push(a.value)}),a.continue()):o.length>0&&t(o)}})}clearData(){if(!this.rd())return!1;var e=[];for(var t in this.ed.$t)this.ed.$t.hasOwnProperty(t)&&this.ed.$t[t]!==this.ed.$t.oe&&e.push(this.ed.$t[t]);var a=this;return this.sd(function(t){var i=t.transaction(e,"readwrite");i.oncomplete=()=>t.close();for(var r=0;r<e.length;r++){var s=e[r];i.objectStore(s).clear().onerror=function(){a.nd.error("Could not clear "+this.source.name+" on indexedDB "+a.ed.dd)}}i.onerror=function(){a.nd.error("Could not clear object stores on indexedDB "+a.ed.dd)}})}}).ep={Ft:{dd:"AppboyServiceWorkerAsyncStorage",VERSION:6,$t:{Kl:"data",jr:"pushClicks",cu:"pushSubscribed",ud:"fallbackDevice",Mt:"cardUpdates",oe:"optOut",$r:"pendingData",Vn:"sdkAuthenticationSignature"},se:1}},es=eR,en={Dn:ei,A:eO,Ar:eM,it:er,qt:a,xt:a.ep,D:es,Go:ez},i=class{constructor(){this.ni={}}ut(e){if("function"!=typeof e)return null;var t=en.it.nt();return this.ni[t]=e,t}removeSubscription(e){delete this.ni[e]}removeAllSubscriptions(){this.ni={}}bu(){return Object.keys(this.ni).length}St(e){var t=[];for(var a in this.ni)t.push(this.ni[a](e));return t}},e("Card",r=class e{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m){this.id=e,this.viewed=t||!1,this.title=a||"",this.imageUrl=i,this.description=r||"",this.created=s||null,this.updated=n||null,this.categories=o||[],this.expiresAt=l||null,this.url=u,this.linkText=h,c=parseFloat(c),this.aspectRatio=isNaN(c)?null:c,this.extras=d,this.pinned=p||!1,this.dismissible=b||!1,this.dismissed=!1,this.clicked=m||!1,this.isControl=!1,this.test=!1,this.lt=null,this.Et=null}subscribeToClickedEvent(e){return this.Tt().ut(e)}subscribeToDismissedEvent(e){return this.It().ut(e)}removeSubscription(e){this.Tt().removeSubscription(e),this.It().removeSubscription(e)}removeAllSubscriptions(){this.Tt().removeAllSubscriptions(),this.It().removeAllSubscriptions()}dismissCard(){if(this.dismissible&&!this.dismissed){this.tt&&this.tt(this);var t=this.X;t&&(t.style.height=t.offsetHeight+"px",t.className=t.className+" ab-hide",setTimeout(function(){t&&t.parentNode&&(t.style.height="0",t.style.margin="0",setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},e.Nt))},500))}}Tt(){return null==this.lt&&(this.lt=new i),this.lt}It(){return null==this.Et&&(this.Et=new i),this.Et}R(){this.viewed=!0}k(){this.viewed=!0,this.clicked=!0,this.Tt().St()}J(){return!(!this.dismissible||this.dismissed)&&(this.dismissed=!0,this.It().St(),!0)}ct(t){if(null==t||t[e.At.ns]!==this.id)return!0;if(t[e.At.Dt])return!1;if(null!=t[e.At.us]&&null!=this.updated&&t[e.At.us]<ej(this.updated.valueOf()))return!0;if(t[e.At.ls]&&!this.viewed&&(this.viewed=!0),t[e.At.gs]&&!this.clicked&&(this.clicked=t[e.At.gs]),null!=t[e.At.ht]&&(this.title=t[e.At.ht]),null!=t[e.At.os]&&(this.imageUrl=t[e.At.os]),null!=t[e.At.rt]&&(this.description=t[e.At.rt]),null!=t[e.At.us]){var a,i=eH(t[e.At.us]);null!=i&&(this.updated=i)}if(null!=t[e.At.ps]&&(a=t[e.At.ps]===e.Ct?null:eH(t[e.At.ps]),this.expiresAt=a),null!=t[e.At.URL]&&(this.url=t[e.At.URL]),null!=t[e.At.bs]&&(this.linkText=t[e.At.bs]),null!=t[e.At.fs]){var r=parseFloat(t[e.At.fs]);this.aspectRatio=isNaN(r)?null:r}return null!=t[e.At.xs]&&(this.extras=t[e.At.xs]),null!=t[e.At.js]&&(this.pinned=t[e.At.js]),null!=t[e.At.zs]&&(this.dismissible=t[e.At.zs]),null!=t[e.At.ks]&&(this.test=t[e.At.ks]),!0}}),r.Ct=-1,r.es={st:"captioned_image",dt:"text_announcement",Rt:"short_news",rs:"banner_image",_t:"control"},r.At={ns:"id",ls:"v",zs:"db",Dt:"r",us:"ca",js:"p",ps:"ea",xs:"e",ts:"tp",os:"i",ht:"tt",rt:"ds",URL:"u",bs:"dm",fs:"ar",gs:"cl",ks:"t"},r.hs={ns:"id",ls:"v",zs:"db",cs:"cr",us:"ca",js:"p",ds:"t",ps:"ea",xs:"e",ts:"tp",os:"i",ht:"tt",rt:"ds",URL:"u",bs:"dm",fs:"ar",gs:"cl",ks:"s"},r.Lt={Ot:"ADVERTISING",bt:"ANNOUNCEMENTS",ft:"NEWS",Pt:"SOCIAL"},r.Nt=400,e("Banner",s=class extends r{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p){super(e,t,null,a,null,i,r,s,n,o,l,u,h,c,d,p),this.Y="ab-banner",this.Z=!1}ss(){var e={};return e[r.hs.ts]=r.es.rs,e[r.hs.ns]=this.id,e[r.hs.ls]=this.viewed,e[r.hs.os]=this.imageUrl,e[r.hs.us]=this.updated,e[r.hs.cs]=this.created,e[r.hs.ds]=this.categories,e[r.hs.ps]=this.expiresAt,e[r.hs.URL]=this.url,e[r.hs.bs]=this.linkText,e[r.hs.fs]=this.aspectRatio,e[r.hs.xs]=this.extras,e[r.hs.js]=this.pinned,e[r.hs.zs]=this.dismissible,e[r.hs.gs]=this.clicked,e[r.hs.ks]=this.test,e}}),e("CaptionedImage",n=class extends r{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m){super(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m),this.Y="ab-captioned-image",this.Z=!0}ss(){var e={};return e[r.hs.ts]=r.es.st,e[r.hs.ns]=this.id,e[r.hs.ls]=this.viewed,e[r.hs.ht]=this.title,e[r.hs.os]=this.imageUrl,e[r.hs.rt]=this.description,e[r.hs.us]=this.updated,e[r.hs.cs]=this.created,e[r.hs.ds]=this.categories,e[r.hs.ps]=this.expiresAt,e[r.hs.URL]=this.url,e[r.hs.bs]=this.linkText,e[r.hs.fs]=this.aspectRatio,e[r.hs.xs]=this.extras,e[r.hs.js]=this.pinned,e[r.hs.zs]=this.dismissible,e[r.hs.gs]=this.clicked,e[r.hs.ks]=this.test,e}}),e("ClassicCard",o=class extends r{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m){super(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m),this.Y="ab-classic-card",this.Z=!0}ss(){var e={};return e[r.hs.ts]=r.es.Rt,e[r.hs.ns]=this.id,e[r.hs.ls]=this.viewed,e[r.hs.ht]=this.title,e[r.hs.os]=this.imageUrl,e[r.hs.rt]=this.description,e[r.hs.us]=this.updated,e[r.hs.cs]=this.created,e[r.hs.ds]=this.categories,e[r.hs.ps]=this.expiresAt,e[r.hs.URL]=this.url,e[r.hs.bs]=this.linkText,e[r.hs.fs]=this.aspectRatio,e[r.hs.xs]=this.extras,e[r.hs.js]=this.pinned,e[r.hs.zs]=this.dismissible,e[r.hs.gs]=this.clicked,e[r.hs.ks]=this.test,e}}),e("ControlCard",l=class extends r{constructor(e,t,a,i,r,s){super(e,t,null,null,null,null,a,null,i,null,null,null,r,s,null),this.isControl=!0,this.Y="ab-control-card",this.Z=!1}ss(){var e={};return e[r.hs.ts]=r.es._t,e[r.hs.ns]=this.id,e[r.hs.ls]=this.viewed,e[r.hs.us]=this.updated,e[r.hs.ps]=this.expiresAt,e[r.hs.xs]=this.extras,e[r.hs.js]=this.pinned,e[r.hs.ks]=this.test,e}}),u=class{constructor(){}tf(){}ef(){}Zo(e){}static rf(e,t){if(e&&t){if(e=e.toLowerCase(),eL(t.if)){for(var a=0;a<t.if.length;a++)if(-1!==e.indexOf(t.if[a].toLowerCase()))return t.identity}else if(-1!==e.indexOf(t.if.toLowerCase()))return t.identity}}},h=class e extends u{constructor(){if(super(),this.userAgentData=navigator.userAgentData,this.userAgentData){var e=this.ic();this.browser=e.browser||"Unknown Browser",this.version=e.version||"Unknown Version"}}tf(){return this.browser}ef(){return this.version}Zo(t){if(this.OS)return Promise.resolve(this.OS);var a=a=>{for(var i=0;i<t.length;i++){var r=e.rf(a,t[i]);if(r)return this.OS=r,this.OS}return a};return this.userAgentData.platform?Promise.resolve(a(this.userAgentData.platform)):this.nc().then(e=>a(e.platform)).catch(()=>navigator.platform)}ic(){var e={},t=this.userAgentData.brands;if(t&&t.length)for(var a of t){var i=this.oc(eZ),r=a.brand.match(i);if(r&&r.length>0){e.browser=r[0],e.version=a.version;break}}return e}oc(e){var t=[];for(var a in e)e[a]!==eZ.Pg&&t.push(e[a]);return RegExp("("+t.join("|")+")","i")}nc(){return this.userAgentData.getHighEntropyValues?this.userAgentData.getHighEntropyValues(["platform"]):Promise.reject()}},c=class e extends u{constructor(){super(),this.Su=e.Vu(navigator.userAgent||"")}tf(){return this.Su[0]||"Unknown Browser"}ef(){return this.Su[1]||"Unknown Version"}Zo(t){for(var a=0;a<t.length;a++){var i=t[a].string,r=e.rf(i,t[a]);if(r)return r===eQ.jg&&navigator.maxTouchPoints>1&&(r=eQ.ln),Promise.resolve(r)}return Promise.resolve(navigator.platform)}static Vu(e){var t,a=e.match(/(samsungbrowser|tizen|roku|konqueror|icab|crios|opera|ucbrowser|chrome|safari|firefox|camino|msie|trident(?=\/))\/?\s*(\.?\d+(\.\d+)*)/i)||[];if(/trident/i.test(a[1]))return t=/\brv[ :]+(\.?\d+(\.\d+)*)/g.exec(e)||[],[eZ.Pg,t[1]||""];if(-1!==e.indexOf("(Web0S; Linux/SmartTV)"))return["LG Smart TV",null];if(-1!==e.indexOf("CrKey"))return["Chromecast",null];if(-1!==e.indexOf("BRAVIA")||-1!==e.indexOf("SonyCEBrowser")||-1!==e.indexOf("SonyDTV"))return["Sony Smart TV",null];if(-1!==e.indexOf("PhilipsTV"))return["Philips Smart TV",null];if(e.match(/\b(Roku)\b/))return["Roku",null];if(e.match(/\bAFTM\b/))return["Amazon Fire Stick",null];if(a[1]===eZ.rE&&null!=(t=e.match(/\b(OPR|Edge|EdgA|Edg|UCBrowser)\/(\.?\d+(\.\d+)*)/)))return(t=t.slice(1))[0]=t[0].replace("OPR",eZ.EE),t[0]=t[0].replace("EdgA",eZ.eE),"Edg"===t[0]&&(t[0]=eZ.eE),[t[0],t[1]];if(a[1]===eZ.kg&&null!=(t=e.match(/\b(EdgiOS)\/(\.?\d+(\.\d+)*)/)))return(t=t.slice(1))[0]=t[0].replace("EdgiOS",eZ.eE),[t[0],t[1]];if((a=a[2]?[a[1],a[2]]:[null,null])[0]===eZ.kg&&null!=(t=e.match(/version\/(\.?\d+(\.\d+)*)/i))&&a.splice(1,1,t[1]),null!=(t=e.match(/\b(UCBrowser)\/(\.?\d+(\.\d+)*)/))&&a.splice(1,1,t[2]),a[0]===eZ.EE&&null!=(t=e.match(/mini\/(\.?\d+(\.\d+)*)/i)))return["Opera Mini",t[1]||""];if(a[0]){var i=a[0].toLowerCase();"msie"===i&&(a[0]=eZ.Pg),"crios"===i&&(a[0]=eZ.rE),"tizen"===i&&(a[0]="Samsung Smart TV",a[1]=null),"samsungbrowser"===i&&(a[0]="Samsung Browser")}return a}},(d=class e{constructor(){var t=navigator.userAgentData?h:c;this.Sg=new t,this.userAgent=navigator.userAgent,this.browser=this.Sg.tf(),this.version=this.Sg.ef(),this.Zo().then(e=>this.OS=e),this.language=(navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage||"").toLowerCase(),this.Fo=e.Bg(this.userAgent)}Og(){return this.browser!==eZ.Pg||this.version>8}ka(){return this.browser===eZ.kg}Xo(){return this.OS||null}Zo(){return this.OS?Promise.resolve(this.OS):this.Sg.Zo(e.xg).then(e=>(this.OS=e,e))}static Bg(e){e=e.toLowerCase();for(var t=["googlebot","bingbot","slurp","duckduckbot","baiduspider","yandex","facebookexternalhit","sogou","ia_archiver","https://github.com/prerender/prerender","aolbuild","bingpreview","msnbot","adsbot","mediapartners-google","teoma"],a=0;a<t.length;a++)if(-1!==e.indexOf(t[a]))return!0;return!1}}).xg=[{string:navigator.platform,if:"Win",identity:eQ.Dg},{string:navigator.platform,if:"Mac",identity:eQ.jg},{string:navigator.platform,if:"BlackBerry",identity:"BlackBerry"},{string:navigator.platform,if:"FreeBSD",identity:"FreeBSD"},{string:navigator.platform,if:"OpenBSD",identity:"OpenBSD"},{string:navigator.platform,if:"Nintendo",identity:"Nintendo"},{string:navigator.platform,if:"SunOS",identity:"SunOS"},{string:navigator.platform,if:"PlayStation",identity:"PlayStation"},{string:navigator.platform,if:"X11",identity:"X11"},{string:navigator.userAgent,if:["iPhone","iPad","iPod"],identity:eQ.ln},{string:navigator.platform,if:"Pike v",identity:eQ.ln},{string:navigator.userAgent,if:["Web0S"],identity:"WebOS"},{string:navigator.platform,if:["Linux armv7l","Android"],identity:eQ.Fg},{string:navigator.userAgent,if:["Android"],identity:eQ.Fg},{string:navigator.platform,if:"Linux",identity:"Linux"}],eo=new d,p=class e{constructor(e,t,a,i,r){this.userId=e,this.type=t,this.time=null==a||""===a?new Date().valueOf():a,this.sessionId=i,this.data=r}Si(){var e={name:this.type,time:ej(this.time),data:this.data||{},session_id:this.sessionId};return null!=this.userId&&(e.user_id=this.userId),e}ss(){return{u:this.userId,t:this.type,ts:this.time,s:this.sessionId,d:this.data}}static fromJson(t){return new e(t.user_id,t.name,t.time,t.session_id,t.data)}static Fa(e){return null!=e&&eq(e)&&null!=e.t&&""!==e.t}static jn(t){return new e(t.u,t.t,t.ts,t.s,t.d)}},b=class e{constructor(e,t,a){null==e&&(e=en.it.nt()),(isNaN(a=parseInt(a))||0===a)&&(a=new Date().valueOf()),this.iu=e,this.wh=a,this.Ch=new Date().valueOf(),this.Dh=t}ss(){return{g:this.iu,e:this.Dh,c:this.wh,l:this.Ch}}static jn(t){if(null==t||null==t.g)return null;var a=new e(t.g,t.e,t.c);return a.Ch=t.l,a}},el=new RegExp(/^.+@.+\..+$/),e("User",m=class e{constructor(e,t){this.v=e,this.si=t}getUserId(e){null==e&&en.D.error("getUserId must be supplied with a callback. e.g., braze.getUser().getUserId(function(userId) {console.log('the user id is ' + userId)})"),"function"==typeof e&&e(this.v.getUserId())}addAlias(e,t){return!te(e,"add alias","the alias",!1)||e.length<=0?(en.D.error("addAlias requires a non-empty alias"),!1):!te(t,"add alias","the label",!1)||t.length<=0?(en.D.error("addAlias requires a non-empty label"),!1):this.si.Nn(e,t).S}setFirstName(e){return!!te(e,"set first name","the firstName",!0)&&this.v.nu("first_name",e)}setLastName(e){return!!te(e,"set last name","the lastName",!0)&&this.v.nu("last_name",e)}setEmail(e){return null===e||"string"==typeof e&&null!=e.toLowerCase().match(el)?this.v.nu("email",e):(en.D.error(`Cannot set email address - "${e}" did not pass RFC-5322 validation.`),!1)}setGender(t){return"string"==typeof t&&(t=t.toLowerCase()),!(null!==t&&!eB(e.Genders,t,`Gender "${t}" is not a valid gender.`,"User.Genders"))&&this.v.nu("gender",t)}setDateOfBirth(e,t,a){return null===e&&null===t&&null===a?this.v.nu("dob",null):(e=parseInt(e),t=parseInt(t),a=parseInt(a),isNaN(e)||isNaN(t)||isNaN(a)||t>12||t<1||a>31||a<1?(en.D.error("Cannot set date of birth - parameters should comprise a valid date e.g. setDateOfBirth(1776, 7, 4);"),!1):this.v.nu("dob",`${e}-${t}-${a}`))}setCountry(e){return!!te(e,"set country","the country",!0)&&this.v.nu("country",e)}setHomeCity(e){return!!te(e,"set home city","the homeCity",!0)&&this.v.nu("home_city",e)}setLanguage(e){return!!te(e,"set language","the language",!0)&&this.v.nu("language",e)}setEmailNotificationSubscriptionType(t){return!!eB(e.NotificationSubscriptionTypes,t,`Email notification setting "${t}" is not a valid subscription type.`,"User.NotificationSubscriptionTypes")&&this.v.nu("email_subscribe",t)}setPushNotificationSubscriptionType(t){return!!eB(e.NotificationSubscriptionTypes,t,`Push notification setting "${t}" is not a valid subscription type.`,"User.NotificationSubscriptionTypes")&&this.v.nu("push_subscribe",t)}setPhoneNumber(t){return!!te(t,"set phone number","the phoneNumber",!0)&&(null===t||t.match(e.Cn)?this.v.nu("phone",t):(en.D.error(`Cannot set phone number - "${t}" did not pass validation.`),!1))}setLastKnownLocation(e,t,a,i,r){return null==e||null==t?(en.D.error("Cannot set last-known location - latitude and longitude are required."),!1):(e=parseFloat(e),t=parseFloat(t),null!=a&&(a=parseFloat(a)),null!=i&&(i=parseFloat(i)),null!=r&&(r=parseFloat(r)),isNaN(e)||isNaN(t)||null!=a&&isNaN(a)||null!=i&&isNaN(i)||null!=r&&isNaN(r)?(en.D.error("Cannot set last-known location - all supplied parameters must be numeric."),!1):e>90||e<-90||t>180||t<-180?(en.D.error("Cannot set last-known location - latitude and longitude are bounded by \xb190 and \xb1180 respectively."),!1):null!=a&&a<0||null!=r&&r<0?(en.D.error("Cannot set last-known location - accuracy and altitudeAccuracy may not be negative."),!1):this.si.setLastKnownLocation(this.v.getUserId(),e,t,i,a,r).S)}setCustomUserAttribute(e,t){if(!tt(e,"set custom user attribute","the given key"))return!1;var a=typeof t,i=eF(t),r=eL(t);if("number"!==a&&"boolean"!==a&&!i&&!r&&null!==t&&!tt(t,`set custom user attribute "${e}"`,"the given value"))return!1;if(i&&(t=eW(t)),r){for(var s=0;s<t.length;s++)if(!tt(t[s],`set custom user attribute "${e}"`,"the element in the given array"))return!1;return this.si.In(en.A.Un,e,t).S}return this.v.setCustomUserAttribute(e,t)}addToCustomAttributeArray(e,t){return!!tt(e,"add to custom user attribute array","the given key")&&!(null!=t&&!tt(t,"add to custom user attribute array","the given value"))&&this.si.In(en.A.En,e,t).S}removeFromCustomAttributeArray(e,t){return!!tt(e,"remove from custom user attribute array","the given key")&&!(null!=t&&!tt(t,"remove from custom user attribute array","the given value"))&&this.si.In(en.A.Fn,e,t).S}incrementCustomUserAttribute(e,t){if(!tt(e,"increment custom user attribute","the given key"))return!1;null==t&&(t=1);var a=parseInt(t);return isNaN(a)||a!==parseFloat(t)?(en.D.error(`Cannot increment custom user attribute because the given incrementValue "${t}" is not an integer.`),!1):this.si.In(en.A.Tn,e,a).S}setCustomLocationAttribute(e,t,a){return!!tt(e,"set custom location attribute","the given key")&&((null!==t||null!==a)&&(t=parseFloat(t),a=parseFloat(a),isNaN(t)||t>90||t<-90||isNaN(a)||a>180||a<-180)?(en.D.error("Received invalid values for latitude and/or longitude. Latitude and longitude are bounded by \xb190 and \xb1180 respectively, or must both be null for removal."),!1):this.si.$n(e,t,a).S)}addToSubscriptionGroup(t){return!te(t,"add user to subscription group","subscription group ID",!1)||t.length<=0?(en.D.error("addToSubscriptionGroup requires a non-empty subscription group ID"),!1):this.si.Bn(t,e.Ln.SUBSCRIBED).S}removeFromSubscriptionGroup(t){return!te(t,"remove user from subscription group","subscription group ID",!1)||t.length<=0?(en.D.error("removeFromSubscriptionGroup requires a non-empty subscription group ID"),!1):this.si.Bn(t,e.Ln.UNSUBSCRIBED).S}Zr(e,t,a,i,r){this.v.Zr(e,t,a,i,r),this.si.Rn()}fn(e){this.v.fn(e)}}),m.Cn=/^[0-9 .\\(\\)\\+\\-]+$/,m.Genders={MALE:"m",FEMALE:"f",OTHER:"o",UNKNOWN:"u",NOT_APPLICABLE:"n",PREFER_NOT_TO_SAY:"p"},m.NotificationSubscriptionTypes={OPTED_IN:"opted_in",SUBSCRIBED:"subscribed",UNSUBSCRIBED:"unsubscribed"},m.Ln={SUBSCRIBED:"subscribed",UNSUBSCRIBED:"unsubscribed"},m.On="user_id",m.lu="custom",m.ee=997,(g=class{constructor(e,t){this.Ma=e,this.Ca=t}ru(e,t){var a=t;null!=t&&t instanceof b&&(a=t.ss()),this.Ma.store(e,a)}ya(e){var t=this.tu(e);null!=t&&(t.Ch=new Date().valueOf(),this.ru(e,t))}tu(e){return b.jn(this.Ma.lr(e))}Hh(e){this.Ma.remove(e)}bo(e){if(null==e||0===e.length)return!1;eL(e)||(e=[e]);var t=this.Ca.lr(tr.q.Ta);null!=t&&eL(t)||(t=[]);for(var a=0;a<e.length;a++)t.push(e[a].ss());return this.Ca.store(tr.q.Ta,t)}Nh(e){return null!=e&&this.bo([e])}Ua(){var e=this.Ca.lr(tr.q.Ta);this.Ca.remove(tr.q.Ta),null==e&&(e=[]);var t=[],a=!1,i=null;if(eL(e))for(var r=0;r<e.length;r++)p.Fa(e[r])?t.push(p.jn(e[r])):i=r;else a=!0;if(a||null!=i){var s="Stored events could not be deserialized as Events";a&&(s+=", was "+Object.prototype.toString.call(e)+" not an array"),null!=i&&(s+=", value at index "+i+" does not look like an event"),s+=", serialized values were of type "+typeof e+": "+JSON.stringify(e),t.push(new p(null,en.A.qs,new Date().valueOf(),null,{e:s}))}return t}B(e,t){return!!eB(tr.q,e,"StorageManager cannot store object.","STORAGE_KEYS.OBJECTS")&&this.Ca.store(e,t)}I(e){return!!eB(tr.q,e,"StorageManager cannot retrieve object.","STORAGE_KEYS.OBJECTS")&&this.Ca.lr(e)}Xs(e){return!!eB(tr.q,e,"StorageManager cannot remove object.","STORAGE_KEYS.OBJECTS")&&(this.Ca.remove(e),!0)}clearData(){for(var e=eG(tr.eu),t=eG(tr.q),a=0;a<e.length;a++){var i=e[a];this.Ma.remove(tr.eu[i])}for(var r=0;r<t.length;r++){var s=t[r];this.Ca.remove(tr.q[s])}}La(e){return e||tr.q.Ka}za(e){var t=this.Ca.lr(tr.q.Ia);null==t&&(t={});var a=this.La(e[m.On]);for(var i in e)i===m.On||null!=t[a]&&null!=t[a][i]||this.mu(e[m.On],i,e[i])}mu(e,t,a){var i=this.Ca.lr(tr.q.Ia);null==i&&(i={});var r=this.La(e),s=i[r];if(null==s&&(s={},null!=e&&(s[m.On]=e)),t===m.lu)for(var n in null==s[t]&&(s[t]={}),a)s[t][n]=a[n];else s[t]=a;return i[r]=s,this.Ca.store(tr.q.Ia,i)}Pa(){var e=this.Ca.lr(tr.q.Ia);this.Ca.remove(tr.q.Ia);var t=[];for(var a in e)null!=e[a]&&t.push(e[a]);return t}ou(e){var t=this.Ca.lr(tr.q.Ia);if(null!=t){var a=this.La(null),i=t[a];null!=i&&(t[a]=void 0,this.Ca.store(tr.q.Ia,t),i[m.On]=e,this.za(i))}var r=this.tu(tr.eu.Sh),s=null;null!=r&&(s=r.iu);var n=this.Ua();if(null!=n)for(var o=0;o<n.length;o++){var l=n[o];null==l.userId&&l.sessionId==s&&(l.userId=e),this.Nh(l)}}xa(){return this.Ca.Ja}})._a=class{constructor(e){this._r=e,this.Ja=eo.ka()?3:10}Va(e){return e+"."+this._r}store(e,t){try{return localStorage.setItem(this.Va(e),JSON.stringify({v:t})),!0}catch(e){return en.D.info("Storage failure: "+e.message),!1}}lr(e){try{var t=JSON.parse(localStorage.getItem(this.Va(e)));return null==t?null:t.v}catch(e){return en.D.info("Storage retrieval failure: "+e.message),null}}remove(e){try{localStorage.removeItem(this.Va(e))}catch(e){return en.D.info("Storage removal failure: "+e.message),!1}}},g.ne=class{constructor(e,t){this._r=e,this.Qa=this.Ha(),this.Wa=576e3,this.Xa=!!t}Va(e){return null!=this._r?e+"."+this._r:e}Ha(){for(var e=0,t=document.location.hostname,a=t.split("."),i="ab._gd";e<a.length-1&&-1===document.cookie.indexOf(i+"="+i);)e++,t="."+a.slice(-1-e).join("."),document.cookie=i+"="+i+";domain="+t+";";return document.cookie=i+"=;expires="+new Date(0).toGMTString()+";domain="+t+";",t}ie(){var e=new Date;return e.setTime(e.getTime()+60*this.Wa*1e3),e.getFullYear()}Za(){for(var e=eU(tr.eu),t=document.cookie.split(";"),a=0;a<t.length;a++){for(var i=t[a];" "===i.charAt(0);)i=i.substring(1);for(var r=!1,s=0;s<e.length;s++)if(0===i.indexOf(e[s])){r=!0;break}if(r){var n=i.split("=")[0];-1===n.indexOf("."+this._r)&&this.$a(n)}}}store(e,t){this.Za();var a,i=new Date;i.setTime(i.getTime()+60*this.Wa*1e3);var r="expires="+i.toUTCString(),s="domain="+this.Qa;a=this.Xa?t:encodeURIComponent(JSON.stringify(t));var n=this.Va(e)+"="+a+";"+r+";"+s+";path=/";return n.length>=4093?(en.D.info("Storage failure: string is "+n.length+" chars which is too large to store as a cookie."),!1):(document.cookie=n,!0)}lr(e){for(var t=[],a=this.Va(e)+"=",i=document.cookie.split(";"),r=0;r<i.length;r++){for(var s=i[r];" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(a))try{var n=void 0;n=this.Xa?s.substring(a.length,s.length):JSON.parse(decodeURIComponent(s.substring(a.length,s.length))),t.push(n)}catch(t){return en.D.info("Storage retrieval failure: "+t.message),this.remove(e),null}}return t.length>0?t[t.length-1]:null}remove(e){this.$a(this.Va(e))}$a(e){var t=e+"=;expires="+new Date(0).toGMTString();document.cookie=t,document.cookie=t+";path=/";var a=t+";domain="+this.Qa;document.cookie=a,document.cookie=a+";path=/"}},g.Oa=class{constructor(){this.El={},this.Sl=5242880,this.Ja=3}store(e,t){var a=this._l(t);return a>this.Sl?(en.D.info("Storage failure: object is "+a+" bytes which is greater than the max of "+this.Sl),!1):(this.El[e]={value:t},!0)}_l(e){for(var t=[],a=[e],i=0;a.length;){var r=a.pop();if("boolean"==typeof r)i+=4;else if("string"==typeof r)i+=2*r.length;else if("number"==typeof r)i+=8;else if("object"==typeof r&&-1===t.indexOf(r))for(var s in t.push(r),r)a.push(r[s])}return i}lr(e){var t=this.El[e];return null==t?null:t.value}remove(e){this.El[e]=null}},g.wa=class{constructor(e,t,a){this.Tl=[],t&&this.Tl.push(new g.ne(e)),a&&this.Tl.push(new g._a(e)),this.Tl.push(new g.Oa(e))}store(e,t){for(var a=!0,i=0;i<this.Tl.length;i++)a=this.Tl[i].store(e,t)&&a;return a}lr(e){for(var t=0;t<this.Tl.length;t++){var a=this.Tl[t].lr(e);if(null!=a)return a}return null}remove(e){for(var t=0;t<this.Tl.length;t++)this.Tl[t].remove(e)}},f=class{constructor(e,t,a){this.h=e,this.xn=t||!1,this.qn=a,this.Gn=new i,this.Hn=0,this.Jn=1}Kn(){return this.xn}Mn(){return this.h.I(tr.q.Qn)}setSdkAuthenticationSignature(e){var t=this.Mn();this.h.B(tr.q.Qn,e);var a=en.xt.Ft;new en.qt(a,en.D).setItem(a.$t.Vn,this.Jn,e),t!==e&&this.Qs()}Wn(){this.h.Xs(tr.q.Qn);var e=en.xt.Ft;new en.qt(e,en.D).br(e.$t.Vn,this.Jn)}subscribeToSdkAuthenticationFailures(e){return this.qn.ut(e)}Xn(e){this.qn.St(e)}Yn(){this.Gn.removeAllSubscriptions()}Zn(){this.Hn+=1}au(){return this.Hn}Qs(){this.Hn=0}},v=class{constructor(){}Rs(){}changeUser(e){}clearData(){}},x=class{constructor(e){this.id=e}Si(){var e={};return null!=this[ts.BROWSER]&&(e.browser=this[ts.BROWSER]),null!=this[ts.BROWSER_VERSION]&&(e.browser_version=this[ts.BROWSER_VERSION]),null!=this[ts.OS]&&(e.os_version=this[ts.OS]),null!=this[ts.RESOLUTION]&&(e.resolution=this[ts.RESOLUTION]),null!=this[ts.LANGUAGE]&&(e.locale=this[ts.LANGUAGE]),null!=this[ts.TIME_ZONE]&&(e.time_zone=this[ts.TIME_ZONE]),null!=this[ts.USER_AGENT]&&(e.user_agent=this[ts.USER_AGENT]),e}},w=class{constructor(e,t){this.h=e,null==t&&(t=eU(ts)),this.xo=t}te(){var e=this.h.tu(tr.eu.Jo);null==e&&(e=new b(en.it.nt()),this.h.ru(tr.eu.Jo,e));for(var t=new x(e.iu),a=0;a<this.xo.length;a++){var i=this.xo[a];switch(i){case ts.BROWSER:t[i]=eo.browser;break;case ts.BROWSER_VERSION:t[i]=eo.version;break;case ts.OS:t[i]=this.qo();break;case ts.RESOLUTION:t[i]=screen.width+"x"+screen.height;break;case ts.LANGUAGE:t[i]=eo.language;break;case ts.TIME_ZONE:t[i]=this.Qo(new Date);break;case ts.USER_AGENT:t[i]=eo.userAgent}}return t}qo(){if(eo.Xo())return eo.Xo();var e=this.h.I(tr.q.Yo);return e&&e.os_version?e.os_version:eo.Zo()}Qo(e){if("undefined"!=typeof Intl&&"function"==typeof Intl.DateTimeFormat)try{if("function"==typeof Intl.DateTimeFormat().resolvedOptions){var t=Intl.DateTimeFormat().resolvedOptions().timeZone;if(null!=t&&""!==t)return t}}catch(t){en.D.info("Intl.DateTimeFormat threw an error, cannot detect user's time zone:"+t.message),e=""}if(!e)return e;var a=e.getTimezoneOffset();return this.sa(a)}sa(e){var t=parseInt(e/60),a=parseInt(e%60),i="GMT";return 0!==e&&(i+=(e<0?"+":"-")+("00"+Math.abs(t)).slice(-2)+":"+("00"+Math.abs(a)).slice(-2)),i}},y=class{constructor(e,t,a,i,r,s,n,o,l,u,h){this.Ur=e,this.h=t,this.Ho=a,this.v=i,this.j=r,this.gt=s,this._r=n,this.Wo=o,this.Uo=l,this.Ko=u,this.oa=h,this.ua=["npm"]}Ps(e,t){var a=this.Ur.te(),i=a.Si();e$(this.h.I(tr.q.Yo),i)||(e.device=i),e.api_key=this._r,e.time=ej(new Date().valueOf(),!0);var r=this.h.I(tr.q.ha)||[],s=this.h.I(tr.q.ca)||"";if(this.ua.length>0&&(!e$(r,this.ua)||s!==this.j.la())&&(e.sdk_metadata=this.ua),e.sdk_version=this.Uo,this.Ko&&(e.sdk_flavor=this.Ko),e.app_version=this.oa,e.device_id=a.id,t){var n=this.v.getUserId();null!=n&&(e.user_id=n)}return e}Os(e,t,a){var i=t.auth_error,r=t.error;if(!i&&!r)return!0;if(i){this.Ho.Zn();var s,n={errorCode:i.error_code};for(var o of a)eL(o)&&"X-Braze-Auth-Signature"===o[0]&&(n.signature=o[1]);e.respond_with&&e.respond_with.user_id?n.userId=e.respond_with.user_id:e.user_id&&(n.userId=e.user_id);var l=i.reason;return l?(n.reason=l,s=`due to ${l}`):s=`with error code ${i.error_code}.`,this.Ho.Kn()||(s+=' Please use the "enableSdkAuthentication" initialization option to enable authentication.'),en.D.error(`SDK Authentication failed ${s}`),this.fa(e.events,e.attributes),this.Ho.Xn(n),!1}if(r){var u=r;switch(u){case tn.ma:var h="Received successful response with empty body.";return ef.G(en.A.qs,{e:h}),en.D.info(h),!1;case tn.pa:var c="Received successful response with invalid JSON";return ef.G(en.A.qs,{e:c+": "+t.response}),en.D.info(c),!1;case tn.Ra:u=`The API key "${e.api_key}" is invalid for the baseUrl ${this.Wo}`;break;case tn.ba:u="Sorry, we are not currently accepting your requests. If you think this is in error, please contact us.";break;case tn.ga:u="No device identifier. Please contact support@braze.com"}en.D.error("Backend error: "+u)}return!1}qa(e,t,a,i){return!!(e&&0!==e.length||t&&0!==t.length||a||i)}Aa(e,t,a,i){var r,s,n,o,l=[],u=e=>e||"",h=u(this.v.getUserId()),c=this.wi(e,t);if(a.length>0){var d=[];for(var p of a){if(r=p.Si(),this.Ho.Kn()){if(h&&!r.user_id){o||((o={}).events=[]),o.events.push(r);continue}if(u(r.user_id)!==h){s||(s=[]),s.push(r);continue}}d.push(r)}d.length>0&&(c.events=d)}if(i.length>0){var b=[];for(var m of i)this.Ho.Kn()&&u(m.user_id)!==h?(n||(n=[]),n.push(m)):b.push(m);b.length>0&&(c.attributes=b)}if(this.fa(s,n),c=this.Ps(c,!0),o){var g={requestData:o=this.Ps(o,!1),headers:this.Bs(o)};l.push(g)}if(c&&!this.qa(c.events,c.attributes,e,t))return o?l:null;var f={requestData:c,headers:this.Bs(c)};return l.push(f),l}fa(e,t){if(e){var a=[];for(var i of e){var r=p.fromJson(i);r.time=1e3*r.time,a.push(r)}this.h.bo(a)}if(t)for(var s of t)this.h.za(s)}Vs(e,t){var a="HTTP error ";null!=e&&(a+=e+" "),a+=t,en.D.error(a)}Fr(e){return ef.G(en.A.Ba,{n:e})}wi(e,t,a){var i={};e&&(i.feed=!0),t&&(i.triggers=!0);var r=null!=a?a:this.v.getUserId();return r&&(i.user_id=r),i.config={config_time:this.gt.Zs()},{respond_with:i}}Bs(e,t,a,i){var r=[["X-Braze-Api-Key",this._r]],s=!1;if(null!=e.respond_with&&e.respond_with.triggers&&(r.push(["X-Braze-TriggersRequest","true"]),s=!0),null!=e.respond_with&&e.respond_with.feed&&(r.push(["X-Braze-FeedRequest","true"]),s=!0),t){r.push(["X-Braze-ContentCardsRequest","true"]);var n=this.h.I(tr.q.As);n&&i||(n=0,this.h.B(tr.q.As,n)),r.push(["BRAZE-SYNC-RETRY-COUNT",n.toString()]),s=!0}if(a&&(r.push(["X-Braze-FeatureFlagsRequest","true"]),s=!0),s&&r.push(["X-Braze-DataRequest","true"]),this.Ho.Kn()){var o=this.Ho.Mn();null!=o&&r.push(["X-Braze-Auth-Signature",o])}return r}Gs(e,t){var a=e.device;a&&a.os_version instanceof Promise?a.os_version.then(a=>{e.device.os_version=a,t()}):t()}Qs(){this.Ho.Qs()}Ks(){return this.Wo}addSdkMetadata(e){for(var t of e)-1===this.ua.indexOf(t)&&this.ua.push(t)}},eu=to,S=class{constructor(e,t){this.S=!!e,this.ve=t||[]}V(e){this.S=this.S&&e.S,this.ve.push(...e.ve)}},eh=tu,A=class{constructor(e,t,a,r,s,n,o,l,u,h){this._r=e,this.Wo=t,this.kl=0,this.yl=o.xa(),this.jl=null,this.j=a,this.Ur=r,this.v=s,this.gt=n,this.h=o,this.Ho=u,this.vt=h,this.$l=l,this.Al=new i,this.ql=50}Fl(e,t){return!e&&!t&&this.Ho.au()>=this.ql}Dl(e){var t=this.j.jh();if(e.length>0){var a=this.v.getUserId();for(var i of e){var r=!i.userId&&!a||i.userId===a;i.type===en.A._h&&r&&(t=!0)}}return t}Ll(e,t,a,i,r,s,n){var o=this;null==a&&(a=!0),a&&this.Pl();var l=this.h.Ua(),u=this.h.Pa(),h=!1,c=(e,t)=>{var n=!1;eu.Hs({url:this.Wo+"/data/",data:e,headers:t,S:a=>{null!=e.respond_with&&e.respond_with.triggers&&(this.kl=Math.max(this.kl-1,0)),this.vt.Os(e,a,t)?(this.Ho.Qs(),this.gt.al(a),null!=e.respond_with&&e.respond_with.user_id!=this.v.getUserId()||(null!=e.device&&this.h.B(tr.q.Yo,e.device),null!=e.sdk_metadata&&(this.h.B(tr.q.ha,e.sdk_metadata),this.h.B(tr.q.ca,this.j.la())),this.$l(a),"function"==typeof i&&i())):a.auth_error&&(n=!0)},error:()=>{null!=e.respond_with&&e.respond_with.triggers&&(this.kl=Math.max(this.kl-1,0)),this.vt.fa(e.events,e.attributes),"function"==typeof r&&r()},Ue:e=>{if("function"==typeof s&&s(e),a&&!h){if(e&&!n)this.Rl();else{var t=this.jl;(null==t||t<1e3*this.yl)&&(t=1e3*this.yl),this.Rl(Math.min(3e5,tl(1e3*this.yl,3*t)))}h=!0}}})},d=this.Dl(l),p=t||d;if(this.Fl(n,d))return void en.D.info("Declining to flush data due to 50 consecutive authentication failures");if(a&&!this.vt.qa(l,u,e,p))return this.Rl(),void("function"==typeof s&&s(!0));var b=this.vt.Aa(e,p,l,u);p&&this.kl++;var m=!1;if(b){var g=function(e){o.vt.Gs(e.requestData,()=>c(e.requestData,e.headers)),m=!0};for(var f of b)g(f)}this.Ho.Kn()&&a&&!m?this.Rl():d&&(en.D.info("Invoking new session subscriptions"),this.Al.St())}Ml(){return this.kl>0}Rl(e){this.Il||(null==e&&(e=1e3*this.yl),this.Pl(),this.Nl=setTimeout(()=>{if(document.hidden){var e="visibilitychange",t=()=>{document.hidden||(document.removeEventListener(e,t,!1),this.Ll())};document.addEventListener(e,t,!1)}else this.Ll()},e),this.jl=e)}Pl(){null!=this.Nl&&(clearTimeout(this.Nl),this.Nl=null)}initialize(){this.Il=!1,this.Rl()}destroy(){this.Al.removeAllSubscriptions(),this.Ho.Yn(),this.Pl(),this.Il=!0,this.Ll(null,null,!1),this.Nl=null}cr(e){return this.Al.ut(e)}openSession(){var e=this.j.la()!==this.j.mo();e&&(this.h.ya(tr.eu.Jo),this.h.ya(tr.eu.su)),this.Ll(null,!1,null,null,null),this.Rn(),e&&Promise.resolve().then(function(){return eD}).then(e=>{if(!this.Il){var t=e.default.aa();if(null!=t&&(eh.isPushPermissionGranted()||eh.isPushBlocked())){var a=()=>{t.Jr()?en.D.info("Push token maintenance is disabled, not refreshing token for backend."):t.subscribe()},i=en.xt.Ft;new en.qt(i,en.D).hr(i.$t.cu,(e,t)=>{t&&a()},()=>{var e=this.h.I(tr.q.Sn);(null==e||e)&&a()})}}})}changeUser(e,t,a){var i=this.v.getUserId();if(i!==e){this.j.Fh(),null!=i&&this.Ll(null,!1,null,null,null),this.v.uu(e),a?this.Ho.setSdkAuthenticationSignature(a):this.Ho.Wn();for(var r=0;r<t.length;r++)t[r].changeUser(null==i);null!=i&&this.h.Xs(tr.q.P),this.h.Xs(tr.q.Yo),this.openSession(),en.D.info('Changed user to "'+e+'".')}else{var s="Doing nothing.";a&&this.Ho.Mn()!==a&&(this.Ho.setSdkAuthenticationSignature(a),s="Updated SDK authentication signature"),en.D.info(`Current user is already ${e}. ${s}`)}}requestImmediateDataFlush(e){this.Pl(),this.j.mo(),this.Ll(null,null,null,null,()=>{en.D.error("Failed to flush data, request will be retried automatically.")},e,!0)}requestFeedRefresh(){this.j.mo(),this.Ll(!0)}zr(e,t){this.j.mo(),en.D.info("Requesting explicit trigger refresh."),this.Ll(null,!0,null,e,t)}Nn(e,t){var a=en.A.Ol,i=ef.G(a,{a:e,l:t});return i&&en.D.info(`Logged alias ${e} with label ${t}`),i}In(e,t,a){if(this.gt.hu(t))return en.D.info(`Custom Attribute "${t}" is blocklisted, ignoring.`),new S;var i=ef.G(e,{key:t,value:a});return i&&en.D.info(`Logged custom attribute: ${t} with value: ${a}`),i}setLastKnownLocation(e,t,a,i,r,s){var n={latitude:t,longitude:a};null!=i&&(n.altitude=i),null!=r&&(n.ll_accuracy=r),null!=s&&(n.alt_accuracy=s);var o=ef.G(en.A.Ul,n,e);return o&&en.D.info(`Set user last known location as ${JSON.stringify(n,null,2)}`),o}kr(e,t){var a=this.j.mo();return new p(this.v.getUserId(),en.A.xl,e,a,{cid:t})}Rn(){var e=en.xt.Ft;new en.qt(e,en.D).setItem(e.$t.Kl,1,{baseUrl:this.Wo,data:{api_key:this._r,device_id:this.Ur.te().id},userId:this.v.getUserId(),sdkAuthEnabled:this.Ho.Kn()})}wr(e){for(var t of e)if(t.api_key===this._r)this.vt.fa(t.events,t.attributes);else{var a=en.xt.Ft;new en.qt(a,en.D).setItem(a.$t.$r,en.it.nt(),t)}}$n(e,t,a){var i,r;return this.gt.hu(e)?(en.D.info(`Custom Attribute "${e}" is blocklisted, ignoring.`),new S):(null===t&&null===a?(i=en.A.Wl,r={key:e}):(i=en.A.Bl,r={key:e,latitude:t,longitude:a}),ef.G(i,r))}Bn(e,t){return ef.G(en.A.Gl,{group_id:e,status:t})}},k=class e{constructor(e,t,a,i,r,s,n,o){this.ol=e||0,this.bl=t||[],this.dl=a||[],this.vl=i||[],this.Cl=r,null!=r&&""!==r||(this.Cl=null),this.gl=s||null,this.ml=n||{},this.cl=o||{}}ss(){return{s:"4.6.3",l:this.ol,e:this.bl,a:this.dl,p:this.vl,m:this.Cl,v:this.gl,c:this.ml,f:this.cl}}static jn(t){var a=t.l;return"4.6.3"!==t.s&&(a=0),new e(a,t.e,t.a,t.p,t.m,t.v,t.c,t.f)}},E=class{constructor(e){this.h=e,this.tl=new i,this.el=new i,this.sl=new i,this.il=null}rl(){if(null==this.il){var e=this.h.I(tr.q.hl);this.il=null!=e?k.jn(e):new k}return this.il}Zs(){return this.rl().ol}al(e){if(null!=e&&null!=e.config){var t=e.config;if(t.time>this.rl().ol){var a=new k(t.time,t.events_blacklist,t.attributes_blacklist,t.purchases_blacklist,t.messaging_session_timeout,t.vapid_public_key,t.content_cards,t.feature_flags),i=!1;null!=a.gl&&this.vn()!==a.gl&&(i=!0);var r=!1;null!=a.ml.enabled&&this.Ys()!==a.ml.enabled&&(r=!0);var s=!1;null!=a.cl.enabled&&this._e()!==a.cl.enabled&&(s=!0),this.il=a,this.h.B(tr.q.hl,a.ss()),i&&this.tl.St(),r&&this.el.St(),s&&this.sl.St()}}}kn(e){var t=this.tl.ut(e);return this.fl&&this.tl.removeSubscription(this.fl),this.fl=t,t}Ms(e){return this.el.ut(e)}qe(e){return this.sl.ut(e)}ge(e){return -1!==this.rl().bl.indexOf(e)}hu(e){return -1!==this.rl().dl.indexOf(e)}Dr(e){return -1!==this.rl().vl.indexOf(e)}wl(){return this.rl().Cl}vn(){return this.rl().gl}Ys(){return this.rl().ml.enabled||!1}_e(){return this.rl().cl.enabled&&null==this.Be()?(ef.G(en.A.qs,{e:"Missing feature flag refresh_rate_limit."}),!1):this.rl().cl.enabled||!1}Be(){return this.rl().cl.refresh_rate_limit}},D=class{constructor(e,t,a,i){this.h=e,this.v=t,this.gt=a,this.dh=1e3,isNaN(i=parseFloat(i))&&(i=1800),i<this.dh/1e3&&(en.D.info("Specified session timeout of "+i+"s is too small, using the minimum session timeout of "+this.dh/1e3+"s instead."),i=this.dh/1e3),this.fh=i}ph(e,t){return new p(this.v.getUserId(),en.A.gh,e,t.iu,{d:ej(e-t.wh)})}la(){var e=this.h.tu(tr.eu.Sh);return null==e?null:e.iu}jh(){var e=new Date().valueOf(),t=this.gt.wl(),a=this.h.I(tr.q.bh);if(null!=a&&null==t)return!1;var i=null==a||e-a>1e3*t;return i&&this.h.B(tr.q.bh,e),i}xh(e,t){return null==t||!(e-t.wh<this.dh)&&t.Dh<e}mo(){var e=new Date().valueOf(),t=e+1e3*this.fh,a=this.h.tu(tr.eu.Sh);if(this.xh(e,a)){var i="Generating session start event with time "+e;if(null!=a){var r=a.Ch;r-a.wh<this.dh&&(r=a.wh+this.Gh),this.h.Nh(this.ph(r,a)),i+=" (old session ended "+r+")"}i+=". Will expire "+t.valueOf(),en.D.info(i);var s=new b(en.it.nt(),t);return this.h.Nh(new p(this.v.getUserId(),en.A._h,e,s.iu)),this.h.ru(tr.eu.Sh,s),null==this.h.I(tr.q.bh)&&this.h.B(tr.q.bh,e),s.iu}return a.Ch=e,a.Dh=t,this.h.ru(tr.eu.Sh,a),a.iu}Fh(){var e=this.h.tu(tr.eu.Sh);null!=e&&(this.h.Hh(tr.eu.Sh),this.h.Nh(this.ph(new Date().valueOf(),e)))}},ec=th,e("ControlMessage",N=class e{constructor(e){this.triggerId=e,this.extras={},this.isControl=!0}static fromJson(t){return new e(t.trigger_id)}}),ed={vu:null,eo:tc},e("InAppMessage",C=class e{constructor(t,a,r,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k,E,D,N,C,_,T){this.message=t,this.messageAlignment=a||e.TextAlignment.CENTER,this.duration=c||5e3,this.slideFrom=r||e.SlideFrom.BOTTOM,this.extras=s||{},this.triggerId=n,this.clickAction=o||e.ClickAction.NONE,this.uri=l,this.openTarget=u||e.OpenTarget.NONE,this.dismissType=h||e.DismissType.AUTO_DISMISS,this.icon=d,this.imageUrl=p,this.imageStyle=b||e.ImageStyle.TOP,this.iconColor=m||e.Ji.Hi,this.iconBackgroundColor=g||e.Ji.Ci,this.backgroundColor=f||e.Ji.Hi,this.textColor=v||e.Ji.Li,this.closeButtonColor=x||e.Ji.Oi,this.animateIn=w,null==this.animateIn&&(this.animateIn=!0),this.animateOut=y,null==this.animateOut&&(this.animateOut=!0),this.header=S,this.headerAlignment=A||e.TextAlignment.CENTER,this.headerTextColor=k||e.Ji.Li,this.frameColor=E||e.Ji.Ri,this.buttons=D||[],this.cropType=N||e.CropType.FIT_CENTER,this.orientation=C,this.htmlId=_,this.css=T,this.isControl=!1,this.Pi=!1,this.nl=!1,this.Ui=!1,this.lt=new i,this.Wi=new i}subscribeToClickedEvent(e){return this.lt.ut(e)}subscribeToDismissedEvent(e){return this.Wi.ut(e)}removeSubscription(e){this.lt.removeSubscription(e),this.Wi.removeSubscription(e)}removeAllSubscriptions(){this.lt.removeAllSubscriptions(),this.Wi.removeAllSubscriptions()}closeMessage(){this.on(this.mn)}Ie(){return!0}ll(){return this.Ie()}an(){return null!=this.htmlId&&this.htmlId.length>4}sn(){return this.an()&&null!=this.css&&this.css.length>0}rn(){if(this.an()&&this.sn())return this.htmlId+"-css"}R(){return!this.Pi&&(this.Pi=!0,!0)}Cr(){return this.Pi}k(){return!this.nl&&(this.nl=!0,this.lt.St(),!0)}J(){return!this.Ui&&(this.Ui=!0,this.Wi.St(),!0)}Ki(t){if(t&&t.parentNode){var a=t.closest(".ab-iam-root");if(null==a&&(a=t),this.Ie()&&null!=a.parentNode){var i=a.parentNode.classList;i&&i.contains(e.Yi)&&i.remove(e.Yi),document.body.removeEventListener("touchmove",e.Xi)}a.className=a.className.replace(e.Vi,e.Qi)}return this.animateOut}on(t,a){if(null!=t){this.mn=null;var i,r=!1;(i=-1===t.className.indexOf("ab-in-app-message")?t.getElementsByClassName("ab-in-app-message")[0]:t)&&(r=this.Ki(i));var s=document.body;if(null!=s)var n=s.scrollTop;var o=()=>{if(t&&t.parentNode){var e=t.closest(".ab-iam-root");null==e&&(e=t),e.parentNode&&e.parentNode.removeChild(e)}if(null!=this.rn()){var i=document.getElementById(this.rn());i&&i.parentNode&&i.parentNode.removeChild(i)}null!=s&&"Safari"===eo.browser&&(s.scrollTop=n),a?a():this.J()};r?setTimeout(o,e.Zi):o(),this.Le&&this.Le.focus()}}Oe(){return document.createTextNode(this.message)}Je(e){var t="";this.message||this.header||!this.Ie()||(t="Modal Image"),e.setAttribute("alt",t)}static Xi(t){t.targetTouches&&t.targetTouches.length>1||t.target.classList&&t.target.classList.contains("ab-message-text")&&t.target.scrollHeight>t.target.clientHeight||document.querySelector(`.${e.Yi}`)&&t.preventDefault()}th(t){this.Ie()&&null!=t.parentNode&&this.orientation!==e.Orientation.LANDSCAPE&&(null!=t.parentNode.classList&&t.parentNode.classList.add(e.Yi),document.body.addEventListener("touchmove",e.Xi,!!tp()&&{passive:!1})),t.className+=" "+e.Vi}static sh(e){if(e.keyCode===tv.ih&&!eg.nn(tj.eh)&&document.querySelectorAll(".ab-modal-interactions").length>0){for(var t=document.getElementsByClassName("ab-html-message"),a=!1,i=0;i<t.length;i++){var r=t[i].contentWindow.document.getElementsByClassName("ab-programmatic-close-button")[0];null!=r&&(tm(r),a=!0)}if(!a){var s=document.querySelectorAll(".ab-modal-interactions > .ab-close-button")[0];null!=s&&tm(s)}}}hh(){this.nh||eg.nn(tj.eh)||(document.addEventListener("keydown",e.sh,!1),eg.rh(()=>{document.removeEventListener("keydown",e.sh)}),this.nh=!0)}}),C.Ji={Li:4281545523,Hi:4294967295,Ci:4278219733,oh:4293914607,lh:4283782485,Ri:3224580915,Oi:4288387995},C.Ge={Eh:"hd",Ee:"ias",uh:"of",Th:"do",Gi:"umt",$i:"tf",ah:"te"},C.SlideFrom={TOP:"TOP",BOTTOM:"BOTTOM"},C.ClickAction={NEWS_FEED:"NEWS_FEED",URI:"URI",NONE:"NONE"},C.DismissType={AUTO_DISMISS:"AUTO_DISMISS",MANUAL:"SWIPE"},C.OpenTarget={NONE:"NONE",BLANK:"BLANK"},C.ImageStyle={TOP:"TOP",GRAPHIC:"GRAPHIC"},C.Orientation={PORTRAIT:"PORTRAIT",LANDSCAPE:"LANDSCAPE"},C.TextAlignment={START:"START",CENTER:"CENTER",END:"END"},C.CropType={CENTER_CROP:"CENTER_CROP",FIT_CENTER:"FIT_CENTER"},C.es={mh:"SLIDEUP",Ih:"MODAL",Ye:"MODAL_STYLED",Tr:"FULL",ul:"WEB_HTML",cn:"HTML"},C.Zi=500,C.Ah=200,C.Vi="ab-show",C.Qi="ab-hide",C.Yi="ab-pause-scrolling",e("HtmlMessage",_=class extends C{constructor(e,t,a,i,r,s,n,o,l,u,h){super(e,null,null,t,a,null,null,null,i=i||C.DismissType.MANUAL,r,null,null,null,null,null,null,null,null,s,n,null,null,null,o,void 0,void 0,void 0,l,u),this.messageFields=h}ll(){return!1}k(e){if(this.un===C.es.ul){if(this.nl)return!1;this.nl=!0}return this.lt.St(e),!0}}),_.es=C.es.ul,e("InAppMessageButton",T=class e{constructor(t,a,r,s,n,o,l){this.text=t||"",this.backgroundColor=a||C.Ji.Ci,this.textColor=r||C.Ji.Hi,this.borderColor=s||this.backgroundColor,this.clickAction=n||C.ClickAction.NONE,this.uri=o,null==l&&(l=e.Mi),this.id=l,this.nl=!1,this.lt=new i}subscribeToClickedEvent(e){return this.lt.ut(e)}removeSubscription(e){this.lt.removeSubscription(e)}removeAllSubscriptions(){this.lt.removeAllSubscriptions()}k(){return!this.nl&&(this.nl=!0,this.lt.St(),!0)}static fromJson(t){return new e(t.text,t.bg_color,t.text_color,t.border_color,t.click_action,t.uri,t.id)}}),T.Mi=-1,e("FullScreenMessage",I=class extends C{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k,E,D,N){super(e,t,null,a,i,r,s,n,o=o||C.DismissType.MANUAL,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k=k||C.CropType.CENTER_CROP,E=E||C.Orientation.PORTRAIT,D,N)}get He(){return C.TextAlignment.CENTER}}),I.es=C.es.Tr,e("ModalMessage",O=class extends C{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k,E,D){super(e,t,null,a,i,r,s,n,o=o||C.DismissType.MANUAL,l,u,h,c,d,p,b,m,g,f,v,x,w,y,S,A,k=k||C.CropType.FIT_CENTER,void 0,E,D)}get He(){return C.TextAlignment.CENTER}}),O.es=C.es.Ih,e("SlideUpMessage",M=class extends C{constructor(e,t,a,i,r,s,n,o,l,u,h,c,d,p,b,m,g,f,v,x,w){super(e,t=t||C.TextAlignment.START,a,i,r,s,n,o,l,u,h,c,null,d,p,b=b||C.Ji.oh,m=m||C.Ji.lh,g,f,v,void 0,void 0,void 0,void 0,void 0,void 0,void 0,x,w)}Ie(){return!1}get He(){return C.TextAlignment.START}Oe(){var e=document.createElement("span");return e.appendChild(document.createTextNode(this.message)),e}th(e){var t=e.getElementsByClassName("ab-in-app-message")[0];ed.eo(t,!0,!0)||(this.slideFrom===C.SlideFrom.TOP?t.style.top="0px":t.style.bottom="0px"),super.th(e)}}),M.es=C.es.mh,P=class e{constructor(e){this.Jl=e}Hl(e){return null==this.Jl||this.Jl===e[0]}static fromJson(t){return new e(t?t.event_name:null)}ss(){return this.Jl}},(R=class e{constructor(t,a,i,r){this.Xl=t,this.Vl=a,this.comparator=i,this.Yl=r,this.Vl===e.yh.Zl&&this.comparator!==e.Rh.Mh&&this.comparator!==e.Rh.Lh&&this.comparator!==e.Rh.Oh&&this.comparator!==e.Rh.Uh&&(this.Yl=eH(this.Yl))}Hl(t){var a=null;switch(null!=t&&(a=t[this.Xl]),this.comparator){case e.Rh.Qh:return null!=a&&a.valueOf()===this.Yl.valueOf();case e.Rh.Xh:return null==a||a.valueOf()!==this.Yl.valueOf();case e.Rh.Bh:return typeof a==typeof this.Yl&&a>this.Yl;case e.Rh.Mh:return this.Vl===e.yh.Zl?null!=a&&eF(a)&&eK(a)<=this.Yl:typeof a==typeof this.Yl&&a>=this.Yl;case e.Rh.kh:return typeof a==typeof this.Yl&&a<this.Yl;case e.Rh.Lh:return this.Vl===e.yh.Zl?null!=a&&eF(a)&&eK(a)>=this.Yl:typeof a==typeof this.Yl&&a<=this.Yl;case e.Rh.Jh:return null!=a&&"string"==typeof a&&typeof a==typeof this.Yl&&null!=a.match(this.Yl);case e.Rh.Vh:return null!=a;case e.Rh.qh:return null==a;case e.Rh.Oh:return null!=a&&eF(a)&&eX(a)<this.Yl;case e.Rh.Uh:return null!=a&&eF(a)&&eX(a)>this.Yl;case e.Rh.Kh:return null==a||typeof a!=typeof this.Yl||"string"!=typeof a||null==a.match(this.Yl)}return!1}static fromJson(t){return new e(t.property_key,t.property_type,t.comparator,t.property_value)}ss(){var e=this.Yl;return eF(this.Yl)&&(e=ej(e.valueOf())),{k:this.Xl,t:this.Vl,c:this.comparator,v:e}}static jn(t){return new e(t.k,t.t,t.c,t.v)}}).Rh={Qh:1,Xh:2,Bh:3,Mh:4,kh:5,Lh:6,Jh:10,Vh:11,qh:12,Oh:15,Uh:16,Kh:17},R.yh={Ph:"boolean",Wh:"number",Yh:"string",Zl:"date"},z=class e{constructor(e){this.filters=e}Hl(e){for(var t=!0,a=0;a<this.filters.length;a++){for(var i=this.filters[a],r=!1,s=0;s<i.length;s++)if(i[s].Hl(e)){r=!0;break}if(!r){t=!1;break}}return t}static fromJson(t){if(null==t||!eL(t))return null;for(var a=[],i=0;i<t.length;i++){for(var r=[],s=t[i],n=0;n<s.length;n++)r.push(R.fromJson(s[n]));a.push(r)}return new e(a)}ss(){for(var e=[],t=0;t<this.filters.length;t++){for(var a=this.filters[t],i=[],r=0;r<a.length;r++)i.push(a[r].ss());e.push(i)}return e}static jn(t){for(var a=[],i=0;i<t.length;i++){for(var r=[],s=t[i],n=0;n<s.length;n++)r.push(R.jn(s[n]));a.push(r)}return new e(a)}},U=class e{constructor(e,t){this.Jl=e,this.Ql=t}Hl(e){if(null==this.Jl||null==this.Ql)return!1;var t=e[0],a=e[1];return t===this.Jl&&this.Ql.Hl(a)}static fromJson(t){return new e(t?t.event_name:null,t?z.fromJson(t.property_filters):null)}ss(){return{e:this.Jl,pf:this.Ql.ss()}}},B=class e{constructor(e,t){this.fu=e,this.du=t}Hl(e){if(null==this.fu)return!1;var t=G.gu(e[0],this.fu);if(!t)return!1;var a=null==this.du||0===this.du.length;if(null!=this.du){for(var i=0;i<this.du.length;i++)if(this.du[i]===e[1]){a=!0;break}}return t&&a}static fromJson(t){return new e(t?t.id:null,t?t.buttons:null)}ss(){return this.fu}},L=class e{constructor(e){this.productId=e}Hl(e){return null==this.productId||e[0]===this.productId}static fromJson(t){return new e(t?t.product_id:null)}ss(){return this.productId}},F=class e{constructor(e,t){this.productId=e,this.Ql=t}Hl(e){if(null==this.productId||null==this.Ql)return!1;var t=e[0],a=e[1];return t===this.productId&&this.Ql.Hl(a)}static fromJson(t){return new e(t?t.product_id:null,t?z.fromJson(t.property_filters):null)}ss(){return{id:this.productId,pf:this.Ql.ss()}}},q=class e{constructor(e){this.fu=e}Hl(e){return null==this.fu||G.gu(e[0],this.fu)}static fromJson(t){return new e(t?t.campaign_id:null)}ss(){return this.fu}},(G=class e{constructor(e,t){this.type=e,this.data=t}ec(t,a){return e.tc[this.type]===t&&(null==this.data||this.data.Hl(a))}static gu(e,t){var a=null;try{a=window.atob(e)}catch(t){return en.D.info("Failed to unencode analytics id "+e+": "+t.message),!1}return t===a.split("_")[0]}static fromJson(t){var a,i=t.type;switch(i){case e.rc.OPEN:a=null;break;case e.rc.Rr:a=L.fromJson(t.data);break;case e.rc.ac:a=F.fromJson(t.data);break;case e.rc.vr:a=q.fromJson(t.data);break;case e.rc.be:a=P.fromJson(t.data);break;case e.rc.sc:a=U.fromJson(t.data);break;case e.rc.Br:a=B.fromJson(t.data);break;case e.rc.ks:a=null}return new e(i,a)}ss(){return{t:this.type,d:this.data?this.data.ss():null}}static jn(t){var a,i;switch(t.t){case e.rc.OPEN:a=null;break;case e.rc.Rr:a=new L(t.d);break;case e.rc.ac:a=new F((i=t.d||{}).id,z.jn(i.pf||[]));break;case e.rc.vr:a=new q(t.d);break;case e.rc.be:a=new P(t.d);break;case e.rc.sc:a=new U((i=t.d||{}).e,z.jn(i.pf||[]));break;case e.rc.Br:a=new B(t.d);break;case e.rc.ks:a=null}return new e(t.t,a)}}).rc={OPEN:"open",Rr:"purchase",ac:"purchase_property",vr:"push_click",be:"custom_event",sc:"custom_event_property",Br:"iam_click",ks:"test"},G.tc={},G.tc[G.rc.OPEN]=tw.OPEN,G.tc[G.rc.Rr]=tw.Rr,G.tc[G.rc.ac]=tw.Rr,G.tc[G.rc.vr]=tw.vr,G.tc[G.rc.be]=tw.be,G.tc[G.rc.sc]=tw.be,G.tc[G.rc.Br]=tw.Br,G.tc[G.rc.ks]=tw.ks,($=class e{constructor(t,a,i,r,s,n,o,l,u,h,c,d){this.id=t,this.$h=a||[],void 0===i&&(i=null),this.startTime=i,void 0===r&&(r=null),this.endTime=r,this.priority=s||0,this.type=n,this.Zh=l||0,null==h&&(h=1e3*(this.Zh+30)),this.xi=h,this.data=o,null==u&&(u=e.pu),this.Tu=u,this.Du=c,this.Pu=d||null}yu(t){return null==this.Pu||this.Tu!==e.pu&&t-this.Pu>=1e3*this.Tu}ju(e){this.Pu=e}wu(e){return Math.max(e+1e3*this.Zh-new Date().valueOf(),0)}Eu(e){var t=new Date().valueOf()-e,a=null==e||isNaN(t)||null==this.xi||t<this.xi;return a||en.D.info(`Trigger action ${this.type} is no longer eligible for display - fired ${t}ms ago and has a timeout of ${this.xi}ms.`),!a}static fromJson(t){for(var a=t.id,i=[],r=0;r<t.trigger_condition.length;r++)i.push(G.fromJson(t.trigger_condition[r]));var s=eH(t.start_time),n=eH(t.end_time),o=t.priority,l=t.type,u=t.delay,h=t.re_eligibility,c=t.timeout,d=t.data,p=t.min_seconds_since_last_trigger;return eB(e.Fi,l,"Could not construct Trigger from server data","Trigger.Types")?new e(a,i,s,n,o,l,d,u,h,c,p):null}ss(){for(var e=[],t=0;t<this.$h.length;t++)e.push(this.$h[t].ss());return{i:this.id,c:e,s:this.startTime,e:this.endTime,p:this.priority,t:this.type,da:this.data,d:this.Zh,r:this.Tu,tm:this.xi,ss:this.Du,ld:this.Pu}}static jn(t){for(var a=[],i=0;i<t.c.length;i++)a.push(G.jn(t.c[i]));return new e(t.i,a,eJ(t.s),eJ(t.e),t.p,t.t,t.da,t.d,t.r,t.tm,t.ss,t.ld)}}).pu=-1,$.Fi={Ei:"inapp",Nu:"templated_iam"},j=class{constructor(e,t,a,r){this.vt=e,this.j=t,this.h=a,this.v=r,this.ni=new i,eg.jt(this.ni),this.li=1e3,this.ui=6e4}pi(){return this.ni}mi(e){return this.ni.ut(e)}gi(){return this.ci}fi(e){this.ci=e}di(e,t){return eB(C.Ge,t,`${t} is not a valid in-app message display failure`,"InAppMessage.DisplayFailures")?ef.G(en.A.vi,{trigger_ids:[e],error_code:t}):new S}G(e,t,a,i){var r,s=new S;if(e instanceof N)r={trigger_ids:[e.triggerId]};else{if(t===en.A.yi||e instanceof _&&t===en.A.ji){if(!e.k(i))return en.D.info("This in-app message has already received a click. Ignoring analytics event."),s}else if(t===en.A.bi&&!e.R())return en.D.info("This in-app message has already received an impression. Ignoring analytics event."),s;r=this.Ii(e)}return null==r?s:(null!=a&&(r.bid=a),ef.G(t,r))}Ai(e,t){var a=new S;if(!e.k())return en.D.info("This in-app message button has already received a click. Ignoring analytics event."),a;var i=this.Ii(t);return null==i?a:e.id===T.Mi?(en.D.info("This in-app message button does not have a tracking id. Not logging event to Braze servers."),a):(null!=e.id&&(i.bid=e.id),ef.G(en.A.ji,i))}zi(e){if(e instanceof C){var t,a=e=>{var t=e2(e);return e8(t)?e5(e3.Di,"In-App Message"):function e(t){if(!ti(t))return!1;var a=t[e1.properties.type];return a===e1.types.ue?e4(e,t[e1.properties.me]):a===e1.types.requestPushPermission}(t)&&!eh.Ti()?e5(e3._i,"In-App Message"):void 0};for(var i of e.buttons)if(i.clickAction===C.ClickAction.URI&&e6.test(i.uri)&&(t=a(i.uri)))return t;return e.clickAction===C.ClickAction.URI&&e6.test(e.uri)?a(e.uri):void 0}}ki(e,t,a,i){var r=this.vt.wi(!1,!1);(r=this.vt.Ps(r)).template={trigger_id:e.triggerId,trigger_event_type:t},null!=a&&(r.template.data=a.Si());var s=this.vt.Bs(r);this.vt.Gs(r,()=>{eu.Hs({url:`${this.vt.Ks()}/template/`,data:r,headers:s,S:async t=>{if(!this.vt.Os(r,t,s))return this.di(e.triggerId,C.Ge.$i),void("function"==typeof e.Bi&&e.Bi());if(this.vt.Qs(),null==t||null==t.templated_message)return void this.di(e.triggerId,C.Ge.$i);var a=t.templated_message;if(a.type!==$.Fi.Ei)return void this.di(e.triggerId,C.Ge.Gi);var i=tx(a.data);if(null==i)return void this.di(e.triggerId,C.Ge.Gi);var n=this.zi(i);if(n)return en.D.error(n),void("function"==typeof e.Bi&&e.Bi());"function"==typeof e.Ni?e.Ni(i):this.di(e.triggerId,C.Ge.$i)},error:r=>{var s=`getting user personalization for message ${e.triggerId}`;if(new Date().valueOf()-e.qi>e.xi)this.di(e.triggerId,C.Ge.$i);else{var n=Math.min(e.xi,this.ui),o=this.li;null==i&&(i=o);var l=Math.min(n,tl(o,3*i));s+=`. Retrying in ${l} ms`,setTimeout(()=>{this.ki(e,t,a,l)},l)}this.vt.Vs(r,s)}})})}Ii(e){if(null==e.triggerId)return en.D.info("The in-app message has no analytics id. Not logging event to Braze servers."),null;var t={};return null!=e.triggerId&&(t.trigger_ids=[e.triggerId]),t}},ep=ty,eb={openUri:tO,so:tT,io:tI,yn:tM},em=tF,H=class e{constructor(e,t,a,i,r){this.triggerId=e,this.Ni=t,this.Bi=a,this.qi=i,this.xi=r}static fromJson(t,a,i,r,s){return null==t||null==t.trigger_id?null:new e(t.trigger_id,a,i,r,s)}},W=class extends v{constructor(e,t,a,i,r){super(),this.tg=e,this.yt=t,this.h=a,this.si=i,this.ig=r,this.sg=[],this.eg=[],this.hg=null,this.og={},this.ng={},this.ag(),this.lg()}gg(){this.hg=this.h.I(tr.q.Na)||this.hg,this.og=this.h.I(tr.q.va)||this.og,this.ng=this.h.I(tr.q.Ga)||this.ng;for(var e=0;e<this.cg.length;e++){var t=this.cg[e];null!=this.ng[t.id]&&t.ju(this.ng[t.id])}}ag(){this.fg=this.h.I(tr.q.Da)||0;for(var e=this.h.I(tr.q.Ya)||[],t=[],a=0;a<e.length;a++)t.push($.jn(e[a]));this.cg=t,this.gg()}lg(){for(var e=this,t=function(t,a,i,r,s){return function(){e.ug(t,a,i,r,s)}},a={},i=0;i<this.cg.length;i++)a[this.cg[i].id]=this.cg[i];for(var r=!1,s=0;s<this.cg.length;s++){var n=this.cg[s];if(null!=this.og[n.id]){for(var o=this.og[n.id],l=[],u=0;u<o.length;u++){var h=o[u],c=n.wu(h.qi);if(c>0){var d=void 0,b=void 0;l.push(h),null!=h.dg&&(d=h.dg),null!=h.mg&&p.Fa(h.mg)&&(b=p.jn(h.mg));var m=[];if(eL(h.pg))for(var g=0;g<h.pg.length;g++){var f=a[h.pg[g]];null!=f&&m.push(f)}this.eg.push(setTimeout(t(n,h.qi,d,b,m),c))}}this.og[n.id].length>l.length&&(this.og[n.id]=l,r=!0,0===this.og[n.id].length&&delete this.og[n.id])}}r&&this.h.B(tr.q.va,this.og)}bg(){for(var e=[],t=0;t<this.cg.length;t++)e.push(this.cg[t].ss());this.fg=new Date().valueOf(),this.h.B(tr.q.Ya,e),this.h.B(tr.q.Da,this.fg)}Tg(){(this.h.I(tr.q.Da)||0)>this.fg?this.ag():this.gg()}Rs(e){var t=!1;if(null!=e&&e.triggers){this.gg();var a={},i={};this.cg=[];for(var r=0;r<e.triggers.length;r++){var s=$.fromJson(e.triggers[r]);null!=this.ng[s.id]&&(s.ju(this.ng[s.id]),a[s.id]=this.ng[s.id]),null!=this.og[s.id]&&(i[s.id]=this.og[s.id]);for(var n=0;n<s.$h.length;n++)if(s.$h[n].ec(tw.ks,null)){t=!0;break}null!=s&&this.cg.push(s)}e$(this.ng,a)||(this.ng=a,this.h.B(tr.q.Ga,this.ng)),e$(this.og,i)||(this.og=i,this.h.B(tr.q.va,this.og)),this.bg(),t&&(en.D.info("Trigger with test condition found, firing test."),this.je(tw.ks)),this.je(tw.OPEN);var o=this.sg;this.sg=[];for(var l=0;l<o.length;l++)this.je.apply(this,o[l])}}async ug(e,t,a,i,r){var s=i=>{this.gg();var r=new Date().valueOf();if(!e.Eu(t))return!1===navigator.onLine&&e.type===$.Fi.Ei&&i.imageUrl?(en.D.info(`Not showing ${e.type} trigger action ${e.id} due to offline state.`),void this.ig.di(e.id,C.Ge.Th)):void(e.yu(r)&&this.yg(e,r,a)?0===this.yt.bu()?en.D.info(`Not displaying trigger ${e.id} because neither automaticallyShowInAppMessages() nor subscribeToInAppMessage() were called.`):(this.yt.St([i]),this.vg(e,r)):en.D.info(`Not displaying trigger ${e.id} because display time fell outside of the acceptable time window.`));e.type===$.Fi.Nu?this.ig.di(e.id,C.Ge.$i):this.ig.di(e.id,C.Ge.ah)},n=()=>{this.gg();var s=r.pop();if(null!=s){if(this.wg(s,t,a,i,r),s.Eu(t)){var o=`Server aborted in-app message display, but the timeout on fallback trigger ${s.id} has already elapsed.`;r.length>0&&(o+=" Continuing to fall back."),en.D.info(o),this.ig.di(s.id,C.Ge.ah),n()}else{en.D.info(`Server aborted in-app message display. Falling back to lower priority ${s.type} trigger action ${e.id}.`);var l=1e3*s.Zh-(new Date().valueOf()-t);l>0?this.eg.push(setTimeout(()=>{this.ug(s,t,a,i,r)},l)):this.ug(s,t,a,i,r)}}};switch(e.type){case $.Fi.Ei:var o=tx(e.data);if(null==o){en.D.error(`Could not parse trigger data for trigger ${e.id}, ignoring.`),this.ig.di(e.id,C.Ge.Gi);break}var l=this.ig.zi(o);if(l){en.D.error(l),n();break}s(o);break;case $.Fi.Nu:var u=H.fromJson(e.data,s,n,t,e.xi);if(null==u){en.D.error(`Could not parse trigger data for trigger ${e.id}, ignoring.`),this.ig.di(e.id,C.Ge.Gi);break}this.ig.ki(u,a,i);break;default:en.D.error(`Trigger ${e.id} was of unexpected type ${e.type}, ignoring.`),this.ig.di(e.id,C.Ge.Gi)}}je(e,t,a){if(eB(tw,e,"Cannot fire trigger action.","TriggerEvents")){if(this.si.Ml())return en.D.info("Trigger sync is currently in progress, awaiting sync completion before firing trigger event."),void this.sg.push(arguments);this.Tg();for(var i=new Date().valueOf(),r=i-this.hg,s=!0,n=!0,o=[],l=0;l<this.cg.length;l++){var u=this.cg[l],h=i+1e3*u.Zh;if(u.yu(h)&&(null==u.startTime||u.startTime<=i)&&(null==u.endTime||u.endTime>=i)){for(var c=!1,d=0;d<u.$h.length;d++)if(u.$h[d].ec(e,t)){c=!0;break}c&&(s=!1,this.yg(u,h,e)&&(n=!1,o.push(u)))}}if(s)return void en.D.info(`Trigger event ${e} did not match any trigger conditions.`);if(n)return void en.D.info(`Ignoring ${e} trigger event because a trigger was displayed ${r/1e3}s ago.`);o.sort((e,t)=>e.priority-t.priority);var p=o.pop();null!=p&&(en.D.info(`Firing ${p.type} trigger action ${p.id} from trigger event ${e}.`),this.wg(p,i,e,a,o),0===p.Zh?this.ug(p,i,e,a,o):this.eg.push(setTimeout(()=>{this.ug(p,i,e,a,o)},1e3*p.Zh)))}}changeUser(e){if(this.cg=[],this.h.Xs(tr.q.Ya),!e){this.sg=[],this.hg=null,this.ng={},this.og={};for(var t=0;t<this.eg.length;t++)clearTimeout(this.eg[t]);this.eg=[],this.h.Xs(tr.q.Na),this.h.Xs(tr.q.Ga),this.h.Xs(tr.q.va)}}clearData(){this.cg=[],this.hg=null,this.ng={},this.og={};for(var e=0;e<this.eg.length;e++)clearTimeout(this.eg[e]);this.eg=[]}yg(e,t,a){if(null==this.hg)return!0;if(a===tw.ks)return en.D.info("Ignoring minimum interval between trigger because it is a test type."),!0;var i=e.Du;return null==i&&(i=this.tg),t-this.hg>=1e3*i}wg(e,t,a,i,r){this.gg(),this.og[e.id]=this.og[e.id]||[];var s,n={};n.qi=t,n.dg=a,null!=i&&(s=i.ss()),n.mg=s;for(var o=[],l=0;l<r.length;l++)o.push(r[l].id);n.pg=o,this.og[e.id].push(n),this.h.B(tr.q.va,this.og)}vg(e,t){this.gg(),e.ju(t),this.hg=t,this.h.B(tr.q.Na,t),this.ng[e.id]=t,this.h.B(tr.q.Ga,this.ng)}},J=class e{constructor(e,t,a,i,r){this.endpoint=e||null,this._n=t||null,this.publicKey=a||null,this.zl=i||null,this.gl=r||null}ss(){return{e:this.endpoint,c:this._n,p:this.publicKey,u:this.zl,v:this.gl}}static jn(t){return new e(t.e,eJ(t.c),t.p,t.u,t.v)}},K=class{constructor(e,t){this.gt=e,this.h=t}getUserId(){var e=this.h.tu(tr.eu.su);if(null==e)return null;var t=e.iu,a=e0(t);if(a>m.ee){for(;a>m.ee;)a=e0(t=t.slice(0,t.length-1));e.iu=t,this.h.ru(tr.eu.su,e)}return t}uu(e){var t=null==this.getUserId();this.h.ru(tr.eu.su,new b(e)),t&&this.h.ou(e)}setCustomUserAttribute(e,t){if(this.gt.hu(e))return en.D.info('Custom Attribute "'+e+'" is blocklisted, ignoring.'),!1;var a={};return a[e]=t,this.nu(m.lu,a,!0)}nu(e,t,a,i){var r=this.h.mu(this.getUserId(),e,t),s="",n=e,o=t;return a&&(s=" custom","object"==typeof t&&(n=Object.keys(t)[0],o=t[n])),!i&&r&&en.D.info(`Logged${s} attribute ${n} with value ${o}`),r}Zr(e,t,a,i,r){this.nu("push_token",e,!1,!0),this.nu("custom_push_public_key",a,!1,!0),this.nu("custom_push_user_auth",i,!1,!0),this.nu("custom_push_vapid_public_key",r,!1,!0);var s=en.xt.Ft,n=new en.qt(s,en.D),o=new J(e,t,a,i,r);this.h.B(tr.q.Sn,o.ss()),n.setItem(s.$t.cu,s.se,!0)}fn(e){if(this.nu("push_token",null,!1,!0),this.nu("custom_push_public_key",null,!1,!0),this.nu("custom_push_user_auth",null,!1,!0),this.nu("custom_push_vapid_public_key",null,!1,!0),e){var t=en.xt.Ft,a=new en.qt(t,en.D);this.h.B(tr.q.Sn,!1),a.setItem(t.$t.cu,t.se,!1)}}},eg=new class e{constructor(){this.Lo=!1,this.Po=!1,this.Ro=new i,this.Mo=new i,this.jo={},this.yo=[],this.Do=[],this.ni=[],this.Uo="4.6.3"}zo(e){this.Ro.ut(e)}rh(e){this.Mo.ut(e)}initialize(t,a){if(this.Bo())return en.D.info("Braze has already been initialized with an API key."),!0;this.jo=a||{};var r,s,n,o,l=this.nn(tj.Io),u=tU(eb.yn());if(u&&"true"===u.brazeLogging&&(l=!0),en.D.init(l),en.D.info(`Initialization Options: ${JSON.stringify(this.jo,null,2)}`),null==t||""===t||"string"!=typeof t)return en.D.error("Braze requires a valid API key to be initialized."),!1;this._r=t;var h=this.nn(tj.po);if(null==h||""===h||"string"!=typeof h)return en.D.error("Braze requires a valid baseUrl to be initialized."),!1;!1===/^https?:/.test(h)&&(h=`https://${h}`);var c=h;if((h=document.createElement("a")).href=c,"/"===h.pathname&&(h=`${h}api/v3`),this.Wo=h.toString(),eo.Fo&&!this.nn(tj.ho))return en.D.info("Ignoring activity from crawler bot "+navigator.userAgent),this.Po=!0,!1;var d=this.nn(e.Eo)||!1;if(this.h=ec.Vo(t,d),new g.ne(null,!0).lr(tr.ae))return en.D.info("Ignoring all activity due to previous opt out"),this.Po=!0,!1;for(var p of eG(this.jo))-1===eU(en.Go).indexOf(p)&&en.D.warn(`Ignoring unknown initialization option '${p}'.`);if(null!=this.nn(tj.Co)){var b=this.nn(tj.Co);-1!==["mparticle","wordpress","tealium"].indexOf(b)?this.Ko=b:en.D.error("Invalid sdk flavor passed: "+b)}var m=this.nn(en.Go._o);if(null!=m){if(eL(m)){for(var v=[],x=0;x<m.length;x++)eB(ts,m[x],"devicePropertyAllowlist contained an invalid value.","DeviceProperties")&&v.push(m[x]);m=v}else en.D.error("devicePropertyAllowlist must be an array. Defaulting to all properties."),m=null}this.Ur=new w(this.h,m),this.gt=new E(this.h),this.v=new K(this.gt,this.h),this.j=new D(this.h,this.v,this.gt,this.nn(tj.No));var S=new i;return this.Ho=new f(this.h,this.nn(tj.Ao),S),this.jt(S),this.vt=new y(this.Ur,this.h,this.Ho,this.v,this.j,this.gt,this._r,this.Wo,this.Uo,this.Ko,this.nn(tj.wo)),this.si=new A(this._r,this.Wo,this.j,this.Ur,this.v,this.gt,this.h,e=>{if(this.Bo())for(var t of this.re())t.Rs(e)},this.Ho,this.vt),this.si.initialize(),en.D.info(`Initialized for the Braze backend at "${this.nn(tj.po)}" with API key "${this._r}".`),null!=this.nn(tj.To)&&(r="enableHtmlInAppMessages",s="initialization option",n="allowUserSuppliedJavascript",o=`The '${r}' ${s} is deprecated.`,n&&(o+=` Please use '${n}' instead.`),en.D.warn(o)),t$.init(),this.gt.qe(()=>{this.Lo&&this.gt._e()&&Promise.resolve().then(function(){return eT}).then(e=>{this.Lo&&(0,e.default)()})}),this.si.cr(()=>{this.Lo&&this.gt._e()&&Promise.resolve().then(function(){return eT}).then(e=>{this.Lo&&(0,e.default)(null,null,!0)})}),this.Ro.St(this.jo),this.Lo=!0,!0}destroy(e){if(en.D.destroy(),this.Bo()){for(var t of(this.Mo.St(),this.Mo.removeAllSubscriptions(),this.yo))t.destroy();for(var a of(this.yo=[],this.Do))a.clearData(!1);this.Do=[],this.removeAllSubscriptions(),this.ni=[],this.si.destroy(),this.si=null,this.Ho=null,this.Ur=null,this.vt=null,this.gt=null,this.j=null,this.v=null,this.jo={},this.Ko=void 0,this.Lo=!1,this.Po=!1,e&&(this.h=null)}}rr(){if(this.$o())return!1;if(!this.Bo())throw Error("Braze must be initialized before calling methods.");return!0}ea(){return this._r}ii(){return this.Ho}Ks(){return this.Wo}ce(){return this.Ur}nr(){return this.vt}nn(e){return this.jo[e]}re(){return this.Do}mr(){return this.si}ir(){return this.gt}g(){return this.j}l(){return this.h}gr(){if(this.v&&this.si)return new m(this.v,this.si)}p(){return this.v}tr(){return!0===this.nn(tj.Oo)||!0===this.nn(tj.To)}u(e){var t=!1;for(var a of this.yo)a===e&&(t=!0);t||this.yo.push(e)}ar(e){var t=!1;for(var a of this.Do)a.constructor===e.constructor&&(t=!0);e instanceof v&&!t&&this.Do.push(e)}jt(e){e instanceof i&&this.ni.push(e)}removeAllSubscriptions(){if(this.rr())for(var e of this.ni)e.removeAllSubscriptions()}removeSubscription(e){if(this.rr())for(var t of this.ni)t.removeSubscription(e)}le(e){this.Po=e}Bo(){return this.Lo}$o(){return this.Po}Ds(){return this.Uo}},ef=tH,X=class{constructor(e,t,a){this.h=e,this.j=t,this.v=a}C(e,t){var a=new S;if(e.k(),null==e.url||""===e.url)return en.D.info(`Card ${e.id} has no url. Not logging click to Braze servers.`),a;if(t){var i=this.h.I(tr.q.$)||{};i[e.id]=!0,this.h.B(tr.q.$,i)}var r=this.N([e]);if(null==r)return a;var s=t?en.A._:en.A.F;return ef.G(s,r)}H(e){var t=new S;if(!e.J())return en.D.info(`Card ${e.id} refused this dismissal. Ignoring analytics event.`),t;var a=this.h.I(tr.q.K)||{};a[e.id]=!0,this.h.B(tr.q.K,a);var i=this.N([e]);return null==i?t:ef.G(en.A.L,i)}M(e,t){var a,i=new S(!0),r=[],s=[];for(var n of(a=t?this.h.I(tr.q.O)||{}:this.h.I(tr.q.P)||{},e))n.R(),n instanceof l?s.push(n):r.push(n),a[n.id]=!0;var o=this.N(r),u=this.N(s);if(null==o&&null==u)return i.S=!1,i;if(t?this.h.B(tr.q.O,a):this.h.B(tr.q.P,a),null!=o){var h=t?en.A.T:en.A.U,c=ef.G(h,o);i.V(c)}if(null!=u&&t){var d=ef.G(en.A.W,u);i.V(d)}return i}N(e){for(var t=null,a=0;a<e.length;a++)null!=e[a].id&&""!==e[a].id&&((t=t||{}).ids=t.ids||[],t.ids.push(e[a].id));return t}},ev=tW,Y=class{constructor(e,t){this.cards=e,this.lastUpdated=t}getUnreadCardCount(){var e=0;for(var t of this.cards)t.viewed||t instanceof l||e++;return e}dr(){throw Error("Must be implemented in a subclass")}logCardImpressions(){throw Error("Must be implemented in subclass")}logCardClick(){throw Error("Must be implemented in subclass")}sr(){throw Error("Must be implemented in subclass")}},Y.ur=6e4,Y.Zi=500,Y.uo=1e4,V=class{constructor(e,t){if(null!=e&&(e=e.toLowerCase()),null!=e&&null==tZ[e]){var a=e.indexOf("-");a>0&&(e=e.substring(0,a))}if(null==tZ[e]){var i="Braze does not yet have a localization for language "+e+", defaulting to English. Please contact us if you are willing and able to help us translate our SDK into this language.";t?en.D.error(i):en.D.info(i),e="en"}this.language=e}get(e){return tZ[this.language][e]}},ex=tQ,ew=Object.freeze({__proto__:null,changeUser:t8}),ey=Object.freeze({__proto__:null,logCustomEvent:t9}),eS=Object.freeze({__proto__:null,logPurchase:ae}),eA=Object.freeze({__proto__:null,requestImmediateDataFlush:aa}),Z=class extends v{constructor(e,t){super(),this.h=e,this.si=t,this.yt=new i,eg.jt(this.yt),this.zt()}zt(){for(var e=this.h.I(tr.q.ei)||[],t=[],a=0;a<e.length;a++){var i,s=tY((i=e[a])[r.hs.ns],i[r.hs.ts],i[r.hs.ls],i[r.hs.ht],i[r.hs.os],i[r.hs.rt],eJ(i[r.hs.cs]),eJ(i[r.hs.us]),i[r.hs.ds],eJ(i[r.hs.ps]),i[r.hs.URL],i[r.hs.bs],i[r.hs.fs],i[r.hs.xs],i[r.hs.js],i[r.hs.zs],i[r.hs.gs],i[r.hs.ks]||!1)||void 0;null!=s&&t.push(s)}this.Zt=t,this.ri=eJ(this.h.I(tr.q.hi))}oi(e){for(var t=[],a=this.h.I(tr.q.P)||{},i={},r=0;r<e.length;r++){var s,n=tY((s=e[r]).id,s.type,s.viewed,s.title,s.image,s.description,eH(s.created),eH(s.updated),s.categories,eH(s.expires_at),s.url,s.domain,s.aspect_ratio,s.extras,!1,!1);null!=n&&(a[n.id]&&(n.viewed=!0,i[n.id]=!0),t.push(n))}this.h.B(tr.q.P,i),this.Zt=t,this.Ss(),this.ri=new Date,this.h.B(tr.q.hi,this.ri)}Ss(){for(var e=[],t=0;t<this.Zt.length;t++)e.push(this.Zt[t].ss());this.h.B(tr.q.ei,e)}Rs(e){null!=e&&e.feed&&(this.zt(),this.oi(e.feed),this.yt.St(new Q(this.Zt.slice(),this.ri)))}ai(){this.zt();for(var e=[],t=new Date,a=0;a<this.Zt.length;a++)(null==this.Zt[a].expiresAt||this.Zt[a].expiresAt>=t)&&e.push(this.Zt[a]);return new Q(e,this.ri)}Is(){this.si.requestFeedRefresh()}Ws(e){return this.yt.ut(e)}clearData(e){null==e&&(e=!1),this.Zt=[],this.ri=null,e&&(this.h.Xs(tr.q.ei),this.h.Xs(tr.q.hi)),this.yt.St(new Q(this.Zt.slice(),this.ri))}},ek=ai,e("Feed",Q=class extends Y{constructor(e,t){super(e,t)}logCardImpressions(e){tX(e,!1)}logCardClick(e){tJ(e,!1)}sr(){ar()}dr(){return!1}}),eE=Object.freeze({__proto__:null,showFeed:an}),(ee=class{constructor(e,t,a,i,r,s,n,o,l,u){this.Sr=e,this._r=t,this.Ur=a,this.Wr=i+"/safari/"+t,this.Nr=r||"/service-worker.js",this.Ir=s,this.gt=n,this.Vr=o||!1,this.Or=l||!1,this.h=u,this.Mr=eh.Yr(),this.Gr=eh.Hr()}Jr(){return this.Or}Kr(e,t,a,i,r){e.unsubscribe().then(e=>{e?this.Lr(t,a,i,r):(en.D.error("Failed to unsubscribe device from push."),"function"==typeof r&&r(!1))}).catch(e=>{en.D.error("Push unsubscription error: "+e),"function"==typeof r&&r(!1)})}Qr(e,t,a){var i,r=(e=>{if("string"==typeof e)return e;if(0!==e.endpoint.indexOf("https://android.googleapis.com/gcm/send"))return e.endpoint;var t=e.endpoint;return e.Xr&&-1===e.endpoint.indexOf(e.Xr)&&(t=e.endpoint+"/"+e.Xr),t})(e),s=null,n=null;if(null!=e.getKey)try{s=btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("p256dh")))),n=btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("auth"))))}catch(e){if("invalid arguments"!==e.message)throw e}var o=e.options&&(i=e.options.applicationServerKey)&&i.byteLength&&i.byteLength>0?btoa(String.fromCharCode.apply(null,new Uint8Array(i))).replace(/\+/g,"-").replace(/\//g,"_"):null;this.Sr.Zr(r,a,s,n,o),r&&"function"==typeof t&&t(r,s,n)}hn(){this.Sr.fn(!0)}dn(e,t){this.Sr.fn(!1),en.D.info(e),"function"==typeof t&&t(!1)}pn(e,t,a,i){if("default"===t.permission)try{window.safari.pushNotification.requestPermission(this.Wr,e,{api_key:this._r,device_id:this.Ur.te().id},t=>{"granted"===t.permission&&this.Sr.setPushNotificationSubscriptionType(m.NotificationSubscriptionTypes.OPTED_IN),this.pn(e,t,a,i)})}catch(e){this.dn("Could not request permission for push: "+e,i)}else"denied"===t.permission?this.dn("The user has blocked notifications from this site, or Safari push is not configured in the Braze dashboard.",i):"granted"===t.permission&&(en.D.info("Device successfully subscribed to push."),this.Qr(t.deviceToken,a,new Date))}bn(e,t,a){var i=i=>{switch(i){case"granted":return void("function"==typeof e&&e());case"default":return void("function"==typeof t&&t());case"denied":return void("function"==typeof a&&a());default:en.D.error("Received unexpected permission result "+i)}},r=!1,s=window.Notification.requestPermission(e=>{r&&i(e)});s?s.then(e=>{i(e)}):r=!0}Lr(e,t,a,i){var r={userVisibleOnly:!0};null!=t&&(r.applicationServerKey=t),e.pushManager.subscribe(r).then(e=>{en.D.info("Device successfully subscribed to push."),this.Qr(e,a,new Date)}).catch(e=>{eh.isPushBlocked()?(en.D.info("Permission for push notifications was denied."),"function"==typeof i&&i(!1)):en.D.error("Push subscription failed: "+e)})}gn(){return this.Vr?navigator.serviceWorker.getRegistration():navigator.serviceWorker.register(this.Nr).then(()=>navigator.serviceWorker.ready.then(e=>(e&&"function"==typeof e.update&&e.update().catch(e=>{en.D.info("ServiceWorker update failed: "+e)}),e)))}wn(e){this.Vr||(e.unregister(),en.D.info("Service worker successfully unregistered."))}subscribe(e,t){if(eh.isPushSupported()){if(this.Mr){if(!this.Vr&&null!=window.location){var a=this.Nr;-1===a.indexOf(window.location.host)&&(a=window.location.host+a),-1===a.indexOf(window.location.protocol)&&(a=window.location.protocol+"//"+a);var i=a.substr(0,a.lastIndexOf("/")+1);if(0!==eb.yn().indexOf(i))return void en.D.error("Cannot subscribe to push from a path higher than the service worker location (tried to subscribe from "+window.location.pathname+" but service worker is at "+a+")")}if(eh.isPushBlocked())return void this.dn("Notifications from this site are blocked. This may be a temporary embargo or a permanent denial.",t);if(this.gt&&!this.gt.vn()&&0===this.gt.Zs())return en.D.info("Waiting for VAPID key from server config before subscribing to push."),void this.gt.kn(()=>{this.subscribe(e,t)});var r=eh.isPushPermissionGranted();this.bn(()=>{r||this.Sr.setPushNotificationSubscriptionType(m.NotificationSubscriptionTypes.OPTED_IN),this.gn().then(a=>{if(null==a)return en.D.error("No service worker registration. Set the `manageServiceWorkerExternally` initialization option to false or ensure that your service worker is registered before calling registerPush."),void("function"==typeof t&&t());a.pushManager.getSubscription().then(i=>{var r=null;if(this.gt&&null!=this.gt.vn()&&(r=en.Dn.Pn(this.gt.vn())),i){var s,n=null,o=null,l=this.h.I(tr.q.Sn);if(l&&!eL(l)){try{s=J.jn(l)._n}catch(e){s=null}null==s||isNaN(s.getTime())||0===s.getTime()||(o=new Date(n=s)).setMonth(n.getMonth()+6)}null!=r&&i.options&&i.options.applicationServerKey&&i.options.applicationServerKey.byteLength&&i.options.applicationServerKey.byteLength>0&&!e$(r,new Uint8Array(i.options.applicationServerKey))?(i.options.applicationServerKey.byteLength>12?en.D.info("Device was already subscribed to push using a different VAPID provider, creating new subscription."):en.D.info("Attempting to upgrade a gcm_sender_id-based push registration to VAPID - depending on the browser this may or may not result in the same gcm_sender_id-based subscription."),this.Kr(i,a,r,e,t)):i.expirationTime&&new Date(i.expirationTime)<=new Date().valueOf()?(en.D.info("Push subscription is expired, creating new subscription."),this.Kr(i,a,r,e,t)):l&&eL(l)?this.Kr(i,a,r,e,t):null==o?(en.D.info("No push subscription creation date found, creating new subscription."),this.Kr(i,a,r,e,t)):o<=new Date().valueOf()?(en.D.info("Push subscription older than 6 months, creating new subscription."),this.Kr(i,a,r,e,t)):(en.D.info("Device already subscribed to push, sending existing subscription to backend."),this.Qr(i,e,n))}else this.Lr(a,r,e,t)}).catch(e=>{en.D.error("Error checking current push subscriptions: "+e)})}).catch(e=>{en.D.error("ServiceWorker registration failed: "+e)})},()=>{var e="Permission for push notifications was ignored.";eh.isPushBlocked()&&(e+=" The browser has automatically blocked further permission requests for a period (probably 1 week)."),en.D.info(e),"function"==typeof t&&t(!0)},()=>{en.D.info("Permission for push notifications was denied."),"function"==typeof t&&t(!1)})}else if(this.Gr){if(null==this.Ir||""===this.Ir)return void en.D.error("You must supply the safariWebsitePushId initialization option in order to use registerPush on Safari");var s=window.safari.pushNotification.permission(this.Ir);this.pn(this.Ir,s,e,t)}}else en.D.info(this.An)}unsubscribe(e,t){eh.isPushSupported()?this.Mr?navigator.serviceWorker.getRegistration().then(a=>{a?a.pushManager.getSubscription().then(i=>{i&&(this.hn(),i.unsubscribe().then(i=>{i?(en.D.info("Device successfully unsubscribed from push."),"function"==typeof e&&e()):(en.D.error("Failed to unsubscribe device from push."),"function"==typeof t&&t()),this.wn(a)}).catch(e=>{en.D.error("Push unsubscription error: "+e),"function"==typeof t&&t()}))}).catch(e=>{en.D.error("Error unsubscribing from push: "+e),"function"==typeof t&&t()}):(en.D.info("Device already unsubscribed from push."),"function"==typeof e&&e())}):this.Gr&&(this.hn(),en.D.info("Device unsubscribed from push."),"function"==typeof e&&e()):en.D.info(this.An)}}).An="Push notifications are not supported in this browser.",eD=Object.freeze({__proto__:null,default:al}),eN=Object.freeze({__proto__:null,requestPushPermission:au}),eC=Object.freeze({__proto__:null,unregisterPush:ah}),e("FeatureFlag",et=class e{constructor(e,t=!1,a={}){this.id=e,this.enabled=t,this.properties=a}getStringProperty(e){if(!this.yr(e))return null;var t=this.properties[e];return this.Er(t,"string")?t.value:null}getNumberProperty(e){if(!this.yr(e))return null;var t=this.properties[e];return this.Er(t,"number")?t.value:null}getBooleanProperty(e){if(!this.yr(e))return null;var t=this.properties[e];return this.Er(t,"boolean")?t.value:null}ss(){var t={};return t[e.hs.ns]=this.id,t[e.hs.Fe]=this.enabled,t[e.hs.we]=this.properties,t}yr(e){return!(!this.properties||!this.properties[e])||(en.D.info(`${e} not found in feature flag properties.`),!1)}Er(e,t){return e.type===t&&typeof e.value===t||(en.D.info(`Property is not of type ${t}.`),!1)}}),et.hs={ns:"id",Fe:"e",we:"pr"},et.At={ns:"id",Fe:"enabled",we:"properties"},ea=class extends v{constructor(e,t,a){super(),this.gt=e,this.vt=t,this.h=a,this.he=new i,this.ye=10,this.Te=null,eg.jt(this.he)}Rs(e){if(this.gt._e()&&null!=e&&e.feature_flags){for(var t of(this.Re=[],e.feature_flags)){var a=function(e){if(e[et.At.ns]&&"boolean"==typeof e[et.At.Fe])return new et(e[et.At.ns],e[et.At.Fe],e[et.At.we]);en.D.info(`Unable to create feature flag from ${JSON.stringify(e,null,2)}`)}(t);a&&this.Re.push(a)}this.De=new Date().getTime(),this.Ne(),this.he.St(this.Re)}}xe(){var e=this.h.I(tr.q.ze)||{},t={};for(var a in e){var i=function(e){if(e[et.hs.ns]&&"boolean"==typeof e[et.hs.Fe])return new et(e[et.hs.ns],e[et.hs.Fe],e[et.hs.we]);en.D.info(`Unable to deserialize feature flag from ${JSON.stringify(e,null,2)}`)}(e[a]);i&&(t[i.id]=i)}return t}Ws(e){return this.he.ut(e)}refreshFeatureFlags(e,t,a,i){if(!this.Se(a))return this.$e||(this.$e=this.gt.qe(()=>{this.refreshFeatureFlags(e,t)})),void("function"==typeof t&&t());null==i&&(i=!0),i&&this.Me();var r=this.vt.Ps({},!0),s=this.vt.Bs(r,!1,!0),n=!1;this.vt.Gs(r,()=>{eu.Hs({url:`${this.vt.Ks()}/feature_flags/sync`,headers:s,data:r,S:a=>{if(!this.vt.Os(r,a,s))return n=!0,void("function"==typeof t&&t());this.vt.Qs(),this.Rs(a),"function"==typeof e&&e()},error:e=>{this.vt.Vs(e,"retrieving feature flags"),n=!0,"function"==typeof t&&t()},Ue:()=>{if(i&&n&&!this.ke){var r=this.Te;(null==r||r<1e3*this.ye)&&(r=1e3*this.ye),this.Ae(Math.min(3e5,tl(1e3*this.ye,3*r)),e,t,a)}}})})}Me(){null!=this.ke&&(clearTimeout(this.ke),this.ke=null)}Ae(e,t,a,i){null==e&&(e=1e3*this.ye),this.Me(),this.ke=setTimeout(()=>{this.refreshFeatureFlags(t,a,i)},e),this.Te=e}Se(e){if(!e){var t=parseFloat(this.gt.Be()),a=!1;if(!isNaN(t)){if(-1===t)return en.D.info("Feature flag refreshes not allowed"),!1;a=new Date().getTime()>=(this.De||0)+1e3*t}if(!a)return en.D.info(`Feature flag refreshes were rate limited to ${t} seconds`),!1}return this.gt._e()}Ne(){for(var e={},t=0;t<this.Re.length;t++){var a=this.Re[t],i=a.ss();e[a.id]=i}this.h.B(tr.q.ze,e),this.h.B(tr.q.Ce,this.De)}},e_=ac,eT=Object.freeze({__proto__:null,default:ad,refreshFeatureFlags:ap}),e({Banner:s,CaptionedImage:n,Card:r,ClassicCard:o,ControlCard:l,ControlMessage:N,DeviceProperties:ts,FeatureFlag:et,Feed:Q,FullScreenMessage:I,HtmlMessage:_,InAppMessage:C,InAppMessageButton:T,ModalMessage:O,SlideUpMessage:M,User:m,WindowUtils:eb,changeUser:t8,destroy:t7,getUser:tP,initialize:t6,logCardClick:tJ,logCardDismissal:tK,logCardImpressions:tX,logCustomEvent:t9,logFeedDisplayed:as,logInAppMessageButtonClick:tL,logInAppMessageClick:tC,logInAppMessageHtmlClick:tz,logInAppMessageImpression:tN,logPurchase:ae,openSession:at,refreshFeatureFlags:ap,removeSubscription:t0,requestFeedRefresh:ar,requestImmediateDataFlush:aa,requestPushPermission:au,showFeed:an,showInAppMessage:tq,subscribeToFeedUpdates:ao,subscribeToInAppMessage:tG,unregisterPush:ah})},[]]},[]]);
